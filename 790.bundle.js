"use strict";(self.webpackChunktab_nodes_tree_extension=self.webpackChunktab_nodes_tree_extension||[]).push([[790,497,39,568],{79868:(e,t,n)=>{n.d(t,{i3:()=>i,yp:()=>a,z2:()=>o});let o=function(e){return e.NextAtRootLevel="NextAtRootLevel",e.SameLevelSibling="SameLevelSibling",e.AsFirstChild="AsFirstChild",e.AsLastChild="AsLastChild",e}({}),i=function(e){return e.AsFirstChild="AsFirstChild",e.AsLastChild="AsLastChild",e}({}),a=function(e){return e.AsFirstChild="AsFirstChild",e.AsLastChild="AsLastChild",e}({})},84590:(e,t,n)=>{n.d(t,{h:()=>o});let o=function(e){return e.FREE="FREE",e.PLUS="PLUS",e.PRO="PRO",e}({})},78154:(e,t,n)=>{n.d(t,{HR:()=>r,_S:()=>i,x7:()=>a,yh:()=>o});let o=function(e){return e.BRANCH_NODE="BRANCH_NODE",e}({}),i=function(e){return e.TAB_NODES_TREE="TAB_NODES_TREE",e.OPTIONS="OPTIONS",e.BRANCH_NODE="BRANCH_NODE",e.SERVICE_WORKER="SERVICE_WORKER",e}({}),a=function(e){return e.SERVICE_WORKER="SERVICE_WORKER",e}({}),r=function(e){return e.SERVICE_WORKER="SERVICE_WORKER",e.OPTIONS_LICENSE_PAGE="OPTIONS_LICENSE_PAGE",e}({})},44788:(e,t,n)=>{n.d(t,{w:()=>r});var o=n(93034),i=n(37390);let a=(0,o.tZ)(!0,o.W4.message,[(0,i.SG)(),r.name]);async function r(e,t){let n=a;e.timestamp=new Date().getTime().toString();let{logTags:i,onLogFailure:r,printLog:s=!0}=null!=t?t:{},d=i?Array.isArray(i)?i:[i]:void 0;d&&(n=(0,o.tZ)(a.ifPrint,a.tagStyle,[...d,...a.prefixTags,e.timestamp])),s&&n.sendP("Send message.",e);try{let t=await chrome.runtime.sendMessage(e);return s&&n.receiveP("Received response.",t),t}catch(e){r?r(e):n.failureP("Error sending message.",e);return}}},7426:(e,t,n)=>{n.d(t,{EJ:()=>a,qt:()=>i});let o=function(e){return e.BlueSky="Blue Sky",e}({}),i={name:"Default",treeBackgroundColor:"#ffffff",nodeStartPadding:0,nodesGap:0,nodeBorderWidth:1,nodeBorderColor:"#e1e1e1",nodeBorderLeftTopRadius:0,nodeBorderLeftBottomRadius:0,tabNodeHeight:32,groupNodeHeight:32,tabNodeBackgroundColor:{angle:135,colorStops:[{colorHex:"#ffffff",percentage:0},{colorHex:"#ffffff",percentage:100}]},tabNodeBackgroundColorHover:{angle:135,colorStops:[{colorHex:"#f3f3f3",percentage:0},{colorHex:"#f3f3f3",percentage:100}]},tabNodeBackgroundColorActive:{angle:135,colorStops:[{colorHex:"#dedede",percentage:0},{colorHex:"#dedede",percentage:100}]},tabNodeBackgroundColorSelected:{angle:135,colorStops:[{colorHex:"#e8e8e8",percentage:0},{colorHex:"#e8e8e8",percentage:100}]},tabNodeBackgroundColorActiveHoverBrightnessPercentage:20,tabNodeBackgroundColorSelectedHoverBrightnessPercentage:20,tabNodeTextStyleActive:{bold:!1,italic:!1,underline:!1,lineThrough:!1},tabNodeTextStyle:{bold:!1,italic:!1,underline:!1,lineThrough:!1},tabNodeTextStyleUnread:{bold:!1,italic:!1,underline:!1,lineThrough:!1},tabNodeTextStyleUnloaded:{bold:!1,italic:!1,underline:!1,lineThrough:!1},tabNodeTextAndIconColor:"#000000",tabNodeTextAndIconColorHover:"#000000",tabNodeTextAndIconColorActive:"#000000",tabNodeTextAndIconColorSelected:"#000000",tabNodeTextAndIconColorUnread:null,tabNodeTextAndIconColorUnloaded:null,tabNodeStylesUnloadedEnabled:!1,tabNodeOpacityStylesUnloaded:{borderOpacityPercentage:75,backgroundOpacityPercentage:50,textOpacityPercentage:50,iconOpacityPercentage:100},tabNodeStylesUnreadEnabled:!1,tabNodeOpacityStylesUnread:{borderOpacityPercentage:100,backgroundOpacityPercentage:100,textOpacityPercentage:100,iconOpacityPercentage:100},nodeDragDropAreaBorderWidth:2,nodeDragDropAreaBorderColor:"#000000"},a={name:o.BlueSky,treeBackgroundColor:"#52bfff42",nodeStartPadding:2,nodesGap:2,nodeBorderWidth:1,nodeBorderColor:"#34beff",nodeBorderLeftTopRadius:5,nodeBorderLeftBottomRadius:5,tabNodeHeight:32,groupNodeHeight:32,tabNodeBackgroundColor:{angle:135,colorStops:[{colorHex:"#52bfff",percentage:0},{colorHex:"#88f6ff",percentage:100}]},tabNodeBackgroundColorHover:{angle:135.19669738972703,colorStops:[{colorHex:"#34a7ea",percentage:0},{colorHex:"#88f6ff",percentage:100}]},tabNodeBackgroundColorActive:{angle:135,colorStops:[{colorHex:"#008adb",percentage:0},{colorHex:"#88f6ff",percentage:100}]},tabNodeBackgroundColorSelected:{angle:135,colorStops:[{colorHex:"#0081ff",percentage:0},{colorHex:"#88f6ff",percentage:100}]},tabNodeBackgroundColorActiveHoverBrightnessPercentage:20,tabNodeBackgroundColorSelectedHoverBrightnessPercentage:20,tabNodeTextStyleActive:{bold:!1,italic:!1,underline:!1,lineThrough:!1},tabNodeTextStyle:{bold:!1,italic:!1,underline:!1,lineThrough:!1},tabNodeTextStyleUnread:{bold:!1,italic:!1,underline:!1,lineThrough:!1},tabNodeTextStyleUnloaded:{bold:!1,italic:!1,underline:!1,lineThrough:!1},tabNodeTextAndIconColor:"#000000",tabNodeTextAndIconColorHover:"#000000",tabNodeTextAndIconColorActive:"#000000",tabNodeTextAndIconColorSelected:"#000000",tabNodeTextAndIconColorUnread:null,tabNodeTextAndIconColorUnloaded:null,tabNodeStylesUnloadedEnabled:!1,tabNodeOpacityStylesUnloaded:{borderOpacityPercentage:75,backgroundOpacityPercentage:50,textOpacityPercentage:50,iconOpacityPercentage:100},tabNodeStylesUnreadEnabled:!1,tabNodeOpacityStylesUnread:{borderOpacityPercentage:100,backgroundOpacityPercentage:100,textOpacityPercentage:100,iconOpacityPercentage:100},nodeDragDropAreaBorderWidth:2,nodeDragDropAreaBorderColor:"#005586"}},78639:(e,t,n)=>{n.d(t,{K:()=>c});var o=n(7426),i=n(2530),a=n(6320),r=n(59721),s=n(38017),d=n(79868),l=n(83840);let c={lastSelectedOptionPageKey:function(e){return e.Theme="theme",e.NodesTreeTheme="nodesTreeTheme",e.NodesTreeThemeCustomization="nodesTreeThemeCustomization",e.NodesTreeSettings="nodesTreeSettings",e.License="license",e.Help="help",e.Support="support",e.KeyboardShortcuts="keyboardShortcuts",e.Discussion="discussion",e.Developer="developer",e}({}).Help,sideMenuCollapsed:!1,nodesTreeSettings:{middleClickCloseTabNodeSetting:!1,promoteFirstChildAsParentOnParentClose:!0,newTabNodePositionNewPageByOpenerTabSetting:r.FR.ChromeDefault,newTabNodePositionByOpenerTabSetting:r.O8.ChromeDefault,newTabNodePositionExternalLinkSetting:r.qS.ChromeDefault,newTabNodePositionBookmarkSetting:r.B8.ChromeDefault,activateNewTabOpenedFromBookmark:!1,dropTabNodeOntoTabNodePositionSetting:r.$K.LastChild,whichTabNodeToActivateAfterTabNodeClosedSettings:a.Mq,createNewTabNodeFixedButtonSettings:{enabled:!0,buttonStyles:{height:24,borderWidth:2,borderRadiusTopLeft:10,borderRadiusTopRight:10},newTabNodePositionModifierKeysMappings:{[d.z2.NextAtRootLevel]:l.A.None,[d.z2.SameLevelSibling]:l.A.Alt,[d.z2.AsFirstChild]:l.A.Shift,[d.z2.AsLastChild]:l.A.WinLinuxCtrlOrMacCmd}},middleClickTreeWhiteSpaceCreateNewTabNodeSettings:{enabled:!0,newTabNodePositionModifierKeysMappings:{[d.z2.NextAtRootLevel]:l.A.None,[d.z2.SameLevelSibling]:l.A.Alt,[d.z2.AsFirstChild]:l.A.Shift,[d.z2.AsLastChild]:l.A.WinLinuxCtrlOrMacCmd}},groupNodeSettings:{createNewTabNodeButtonPositionModifierKeysMappings:{[d.i3.AsFirstChild]:l.A.None,[d.i3.AsLastChild]:l.A.WinLinuxCtrlOrMacCmd},expandOrCollapseClickActionSettings:{enabled:!0,clickAction:l.C.Single}},branchTabNodeSettings:{createNewTabNodeButtonPositionModifierKeysMappings:{[d.yp.AsFirstChild]:l.A.None,[d.yp.AsLastChild]:l.A.WinLinuxCtrlOrMacCmd}},subtreeSettings:{parentTabNodeCloseButtonActionModifierKeysMappings:{[r.Ic.CloseParentTabNode]:l.A.None,[r.Ic.CloseParentTabNodeAndChildren]:l.A.WinLinuxCtrlOrMacCmd},parentTabNodeDraggingActionModifierKeysMappings:{[r.Tw.DragWholeSubTree]:l.A.None,[r.Tw.DragParentTabNode]:l.A.WinLinuxCtrlOrMacCmd},expandOrCollapseClickActionSettings:{enabled:!0,clickAction:l.C.Single}},performanceSettings:{hideTabNodeContentDeferredSeconds:5,offscreenExtendedPercentage:10}},themeSettings:{selectedTheme:s.Sh.System,darkTheme:s.WN,lightTheme:s.WN,customizedTabNodesTreeThemeSettings:{enabled:!1,selectedThemeName:o.EJ.name,savedThemes:[o.EJ]}},developerSettings:{showNodeIndex:!1,showTabIdUponHoveringTabNode:!1,preventDefaultContextMenu:!i.A.isDev,showDevelopItemsOnNodesTreeContextMenu:!1}}},38017:(e,t,n)=>{n.d(t,{Sh:()=>o,Sx:()=>i,WN:()=>a});let o=function(e){return e.System="system",e}({}),i=function(e){return e.Dark="dark",e.Light="light",e}({});o.System,i.Dark,i.Light;let a={tabNodeTextAndIconColorUnread:null,tabNodeTextStyleUnread:{bold:!1,italic:!1,underline:!1,lineThrough:!1},tabNodeOpacityStylesUnread:{borderOpacityPercentage:100,backgroundOpacityPercentage:100,textOpacityPercentage:100,iconOpacityPercentage:100},tabNodeTextAndIconColorUnloaded:null,tabNodeTextStyleUnloaded:{bold:!1,italic:!1,underline:!1,lineThrough:!1},tabNodeOpacityStylesUnloaded:{borderOpacityPercentage:100,backgroundOpacityPercentage:100,textOpacityPercentage:100,iconOpacityPercentage:100}}},6320:(e,t,n)=>{n.d(t,{Mq:()=>c,WQ:()=>o,_3:()=>l});let o=function(e){return e.ChromeDefault="ChromeDefault",e.CustomizedRules="CustomizedRules",e}({}),i=function(e){return e.ActivateFirstChild="ActivateFirstChild",e.ActivateLastChild="ActivateLastChild",e.Ignore="Ignore",e}({}),a=function(e){return e.ActivateParent="ActivateParent",e}({}),r=function(e){return e.ActivateAbove="ActivateAbove",e.ActivateAboveElseBelow="ActivateAboveElseBelow",e.ActivateBelow="ActivateBelow",e.ActivateBelowElseAbove="ActivateBelowElseAbove",e.Ignore="Ignore",e}({}),s=function(e){return e.ActivateFirstUnread="ActivateFirstUnread",e.ActivateLastUnread="ActivateLastUnread",e.Ignore="Ignore",e}({}),d=function(e){return e.ActivateAboveSibling="ActivateAboveSibling",e.ActivateAbove="ActivateAbove",e.ActivateBelow="ActivateBelow",e}({}),l=function(e){return e.WhenHasChildren="WhenHasChildren",e.WhenHasParent="WhenHasParent",e.WhenHasParentAndSiblings="WhenHasParentAndSiblings",e.WhenHasNeitherParentNorChildren="WhenHasNeitherParentNorChildren",e}({}),c={settingType:o.ChromeDefault,rulesConditionOrder:[l.WhenHasChildren,l.WhenHasParentAndSiblings,l.WhenHasParent,l.WhenHasNeitherParentNorChildren],[l.WhenHasChildren]:i.ActivateFirstChild,[l.WhenHasParentAndSiblings]:{hasUnreadSiblingsRule:s.ActivateFirstUnread,hasSiblingsRule:r.Ignore},[l.WhenHasParent]:a.ActivateParent,[l.WhenHasNeitherParentNorChildren]:d.ActivateBelow}},3022:(e,t,n)=>{n.d(t,{F1:()=>a,TX:()=>r,my:()=>i,vJ:()=>o});let o={grey:{color:"#dadce0",textColor:"#000"},blue:{color:"#8ab4f8",textColor:"#000"},red:{color:"#f28b82",textColor:"#000"},yellow:{color:"#fdd663",textColor:"#000"},green:{color:"#81c995",textColor:"#000"},pink:{color:"#ff8bcb",textColor:"#000"},purple:{color:"#c58af9",textColor:"#000"},cyan:{color:"#78d9ec",textColor:"#000"},orange:{color:"#fcad70",textColor:"#000"}},i=15,a=chrome.runtime.getURL("branch-tab-node.html");chrome.runtime.getURL("options.html");let r=.5},43393:(e,t,n)=>{n.d(t,{UI:()=>o});let o=function(e){return e.ACTIVE="ACTIVE",e.INACTIVE="INACTIVE",e.EXPIRING="EXPIRING",e.EXPIRED="EXPIRED",e.SUSPENDED="SUSPENDED",e.BANNED="BANNED",e}({})},27566:(e,t,n)=>{n.d(t,{AW:()=>b,F2:()=>u,Ss:()=>h,X7:()=>p});var o=n(77638),i=n(35904),a=n(54510),r=n(94778),s=n(24817),d=n(2530),l=n(37390),c=n(3735);class g extends o.X{constructor(e,t,n,o=(e,t,n)=>n[e],i="local"){super(e),this.storage=t,this.extractDataFun=n,this.loadDataFromChangesFun=o,this.area=i}nativeAddListener(e){chrome.storage.onChanged.addListener(e)}nativeRemoveListener(e){chrome.storage.onChanged.removeListener(e)}provideCallback(e,t,n,o,i){let a=this.storage,r=this.area,s=this.extractDataFun,c=this.loadDataFromChangesFun,g=this;return async function(n,u){if(u!==r)return;let p=c(a.storageKey,t,n);if(p){let r=p.newValue,c=p.oldValue;s&&(void 0!==r&&(r=await s(r,t)),void 0!==c&&(c=await s(c,t)));let b=JSON.stringify(r)!==JSON.stringify(c),h=function(){o.logP({differences:d.A.isDev?(0,l.Gq)(c,r):void 0,changed:b,changes:n,areaName:u,storageKey:a.storageKey,storageChange:n[a.storageKey],oldData:c,newData:r,listeners:g.getListenersLog()})};i.onlyPrintOnChange?b&&h():h(),b&&e(c,r)}}}}let u=new g("licenseAuthDataChangeListenerManager",i.k,async e=>e),p=new g("encryptedLicenseDataChangeListenerManager",a.g,async e=>e);new g("treeDataChangeListenerManager",c.L,async(e,t)=>e);let b=new g("branchNodeDescendantNodesDataChangeListenerManager",c.L,async(e,t)=>{let{windowId:n,branchTabId:o}=t;return null==e?void 0:e.filter(e=>(0,s.q8)(e)&&(e.id===o||e.ancestralNodeIds.includes(o))).map(e=>(delete e.status,e))},(e,t,n)=>n[c.L.getTreeNodesDataStorageKey(t.windowId)]),h=new g("optionsDataChangeListenerManager",r.O,async e=>e);new g("treeSettingsDataChangeListenerManager",r.O,async e=>e.nodesTreeSettings),new g("themeOptionsDataChangeListenerManager",r.O,async e=>e.themeSettings),new g("developerOptionsDataChangeListenerManager",r.O,async e=>e.developerSettings),new g("customizedTabNodesTreeThemesOptionsDataChangeListenerManager",r.O,async e=>e.themeSettings.customizedTabNodesTreeThemeSettings)},94475:(e,t,n)=>{var o=n(62567),i=n(87521),a=n(87855),r=n(93034),s=n(24817),d=n(92935),l=n.n(d),c=n(79868),g=n(65343),u=n(68687);let p=(0,r.tZ)(!0,r.W4.action,b.name);async function b(e,t,n){let r={url:e};switch(n.nodeType){case"tabNode":if(n.pinned)r=Object.assign(Object.assign({},r),{index:n.index+1});else switch(t){case c.z2.SameLevelSibling:r=Object.assign(Object.assign({},r),{openerTabId:n.id,index:(0,s.nJ)(n)});break;case c.z2.AsFirstChild:r=Object.assign(Object.assign({},r),{openerTabId:n.id,index:n.index+1});break;case c.z2.AsLastChild:r=Object.assign(Object.assign({},r),{openerTabId:n.id,index:(0,s.nJ)(n)});break;case c.z2.NextAtRootLevel:r=Object.assign(Object.assign({},r),{openerTabId:n.id,index:(0,s.Z0)(n,i.store.nodesTree.nodes)})}break;case"groupNode":switch(t){case c.z2.AsFirstChild:let d=(0,s.um)(n,i.store.nodesTree.nodes);if(!d){p.error("Cannot find the first child tab node of the group node.");return}r=Object.assign(Object.assign({},r),{index:d.index});break;case c.z2.AsLastChild:let b=(0,s.IB)(n,i.store.nodesTree.nodes);if(!b){p.error("Cannot find the last child tab node of the group node.");return}r=Object.assign(Object.assign({},r),{index:b.index+1});break;case c.z2.SameLevelSibling:case c.z2.NextAtRootLevel:return}}i.store.chromeEventListeners.toggleAllListeners(!1),p.gP("create new tab",{openerNode:n,position:t,createTabProperties:r});try{let e,d;switch(n.nodeType){case"tabNode":if((0,s.y7)(n)){if(p.log('Opener tab is in a group. To avoid "Saved groups are not editable." error when creating a tab with index. We create a tab without index first, then add to the group and move to the right index.',r),e=await chrome.tabs.create(l().pick(r,"url","openerTabId")),p.log("New tab created",e),!e.id)return;await chrome.tabs.group({tabIds:e.id,groupId:n.groupId}),r.index&&await chrome.tabs.move(e.id,{index:r.index})}else{if(e=await chrome.tabs.create(r),p.log("New tab created",e),!e.id)return;e.groupId!==n.groupId&&(p.log("Add to group.",{tabId:e.id,openerNodeGroupId:n.groupId}),await chrome.tabs.group({tabIds:e.id,groupId:n.groupId}))}if(n.pinned)d={oldNodes:i.store.nodesTree.nodes,fixMissingParents:!1};else{let o=(0,u.WB)(i.store.nodesTree.nodes,n,!0);switch(t){case c.z2.SameLevelSibling:d={oldNodes:o,fixMissingParents:!1,nodesWithNewProperties:{[e.id]:{ancestralNodeIds:(0,g.c)(n,{includeOpenerTabNode:!1})}}};break;case c.z2.AsFirstChild:case c.z2.AsLastChild:d={oldNodes:o,fixMissingParents:!1,nodesWithNewProperties:{[e.id]:{ancestralNodeIds:(0,g.c)(n,{includeOpenerTabNode:!0})}}};break;case c.z2.NextAtRootLevel:d={oldNodes:o,fixMissingParents:!1}}}break;case"groupNode":if(e=await chrome.tabs.create(r),p.log("New tab created",e),!e.id)return;switch(e.groupId!==n.id&&(p.log("Add to group.",{tabId:e.id,openerNodeGroupId:n.id}),await chrome.tabs.group({tabIds:e.id,groupId:n.id})),d={oldNodes:(0,u.WB)(i.store.nodesTree.nodes,n,!0),fixMissingParents:!1},t){case c.z2.AsFirstChild:case c.z2.AsLastChild:case c.z2.SameLevelSibling:case c.z2.NextAtRootLevel:}}d&&a.s.pushAsync({logger:p,run:async()=>{await (0,o.O)(d)}})}catch(e){p.error(e)}finally{p.ge(),i.store.chromeEventListeners.toggleAllListeners(!0)}}},87521:(e,t,n)=>{n.r(t),n.d(t,{rtkStoreManager:()=>N,store:()=>T});var o=n(69469),i=n(67426),a=n(59),r=n(35497),s=n(70449),d=n(36840),l=n(20768),c=n(80363),g=n(41861),u=n(83246),p=n(14207),b=n(57866),h=n(37390);let N={nodesTree:{useNodesDataLoaded:()=>(0,i.t)(e=>e.nodesTree.nodesDataLoaded),get nodesDataLoaded(){return i.store.getState().nodesTree.nodesDataLoaded},get treeFinishedInitialTransition(){return i.store.getState().nodesTree.treeFinishedInitialTransition},setTreeFinishedInitialTransition(e){i.store.dispatch((0,o.yO)(e))},useTreeFinishedInitialTransition:()=>(0,i.t)(e=>e.nodesTree.treeFinishedInitialTransition),get nodes(){return i.store.getState().nodesTree.nodes},useNodes:()=>(0,i.t)(e=>e.nodesTree.nodes),setNodes(e,t){i.store.dispatch((0,o.CU)({nodes:e,nodesDataLoaded:t}))},useGroupNode:e=>(0,i.t)(t=>{var n;return void 0===e?void 0:null===(n=t.nodesTree.nodes)||void 0===n?void 0:n.filter(t=>"groupNode"===t.nodeType&&t.id===e)[0]}),get selectionStartTabId(){return i.store.getState().nodesTree.selectionStartTabId},setSelectionStartTabId(e){i.store.dispatch((0,o.FQ)(e))},get draggingNode(){return i.store.getState().nodesTree.draggingNode},useDraggingNode:()=>(0,i.t)(e=>e.nodesTree.draggingNode),setDraggingNode(e){i.store.dispatch((0,o.an)(e))},async loadTreeNodesFromStorage(e){await i.store.dispatch((0,o.tx)(e))},useStyles:()=>(0,i.t)(e=>e.nodesTree.styles),get styles(){return i.store.getState().nodesTree.styles},setStyles(e){i.store.dispatch((0,o.RR)(e))},useEssentialStyles:()=>(0,i.t)(e=>e.nodesTree.styles.essentialConstructTreeStyles),get essentialStyles(){return i.store.getState().nodesTree.styles.essentialConstructTreeStyles},useTabNodeOpacityStyles:()=>(0,i.t)(e=>e.nodesTree.styles.tabNodeStatusOpacityStyles),get tabNodeOpacityStyles(){return i.store.getState().nodesTree.styles.tabNodeStatusOpacityStyles}},dialogs:{setDialogState(e){i.store.dispatch((0,s.q)(e))},useDialogState:()=>(0,i.t)(e=>e.dialogs.dialogState),setGroupNodeConfigDialogState(e){i.store.dispatch((0,s.Yn)(e))},useGroupConfigDialogState:()=>(0,i.t)(e=>e.dialogs.groupNodeConfigDialog)},message:{setMessageState(e){i.store.dispatch((0,p.X)(e))},useMessageState:()=>(0,i.t)(e=>e.message.message)},popupMenu:{get popupMenu(){return i.store.getState().popupMenu.popupMenu},async setPopupMenu(e){await i.store.dispatch((0,r.a)(e))},usePopupMenu:()=>(0,i.t)(e=>e.popupMenu.popupMenu)},chromeEventListeners:{toggleListeners(e,t){i.store.dispatch((0,a.Kn)({enabled:e,listeners:t}))},toggleAllListeners(e){i.store.dispatch((0,a.Kn)({enabled:e,listeners:b.B.ANY}))},isListenerDisabled:e=>(0,a.bh)(e)},chromeStorageChangeListeners:{disableListenerIds(...e){i.store.dispatch((0,l.dx)(e))},enableListenerIds(...e){i.store.dispatch((0,l.Wc)(e))},isListenerDisabled:e=>(0,l.SE)(e)},windowLocalStorageChangeListeners:{disableListenerIds(...e){i.store.dispatch((0,c.dx)(e))},enableListenerIds(...e){i.store.dispatch((0,c.Wc)(e))},isListenerDisabled:e=>(0,c.$k)(e)},options:{get options(){return i.store.getState().options},setOptions(e){i.store.dispatch((0,d.hn)(e))},async loadOptionsFromStorage(e){await i.store.dispatch((0,d.ZG)(e))},setLastSelectedOptionPage(e){i.store.dispatch((0,d.aE)(e))},useLastSelectedOptionPageKey:()=>(0,i.t)(e=>e.options.lastSelectedOptionPageKey),useSideMenuCollapsed:()=>(0,i.t)(e=>e.options.sideMenuCollapsed),setSideMenuCollapsed(e){i.store.dispatch((0,d.cT)(e))},get themeSettings(){return i.store.getState().options.themeSettings},useThemeSettings:e=>(0,i.t)(e=>e.options.themeSettings,{equalityFn:(t,n)=>(0,h.r$)(t,n,{ifPrint:!0,logTags:[...(0,h.eC)(null==e?void 0:e.logTags),"storeManager.useThemeSettings"]})}),setThemeSettings(e){i.store.dispatch((0,d.Tb)(e))},get customizedTabNodesTreeThemeSettings(){return i.store.getState().options.themeSettings.customizedTabNodesTreeThemeSettings},useCustomizedTabNodesTreeThemeSettings:()=>(0,i.t)(e=>e.options.themeSettings.customizedTabNodesTreeThemeSettings,{equalityFn:(e,t)=>(0,h.r$)(e,t,{ifPrint:!0,logTags:"storeManager.useCustomizedTabNodesTreeThemeSettings"})}),setCustomizedTabNodesTreeThemeSettings(e){i.store.dispatch((0,d.hb)(e))},nodesTreeSettings:{get promoteFirstChildAsParentOnParentCloseSetting(){return i.store.getState().options.nodesTreeSettings.promoteFirstChildAsParentOnParentClose},usePromoteFirstChildAsParentOnParentCloseSetting:()=>(0,i.t)(e=>e.options.nodesTreeSettings.promoteFirstChildAsParentOnParentClose),get middleClickCloseTabNodeSetting(){return i.store.getState().options.nodesTreeSettings.middleClickCloseTabNodeSetting},useMiddleClickCloseTabNodeSetting:()=>(0,i.t)(e=>e.options.nodesTreeSettings.middleClickCloseTabNodeSetting),get createNewTabButtonEnabled(){return i.store.getState().options.nodesTreeSettings.createNewTabNodeFixedButtonSettings.enabled},useCreateNewTabButtonEnabled:()=>(0,i.t)(e=>e.options.nodesTreeSettings.createNewTabNodeFixedButtonSettings.enabled),get createNewTabNodeFixedButtonSettings(){return i.store.getState().options.nodesTreeSettings.createNewTabNodeFixedButtonSettings},useCreateNewTabNodeFixedButtonSettings:()=>(0,i.t)(e=>e.options.nodesTreeSettings.createNewTabNodeFixedButtonSettings),get middleClickTreeWhiteSpaceCreateNewTabNodeSettings(){return i.store.getState().options.nodesTreeSettings.middleClickTreeWhiteSpaceCreateNewTabNodeSettings},useMiddleClickTreeWhiteSpaceCreateNewTabNodeSettings:()=>(0,i.t)(e=>e.options.nodesTreeSettings.middleClickTreeWhiteSpaceCreateNewTabNodeSettings),subtreeSettings:{get parentTabNodeCloseButtonActionModifierKeysMappings(){return i.store.getState().options.nodesTreeSettings.subtreeSettings.parentTabNodeCloseButtonActionModifierKeysMappings},useParentTabNodeCloseButtonActionModifierKeysMappings:()=>(0,i.t)(e=>e.options.nodesTreeSettings.subtreeSettings.parentTabNodeCloseButtonActionModifierKeysMappings),get parentTabNodeDraggingActionModifierKeysMappings(){return i.store.getState().options.nodesTreeSettings.subtreeSettings.parentTabNodeDraggingActionModifierKeysMappings},useParentTabNodeDraggingActionModifierKeysMappings:()=>(0,i.t)(e=>e.options.nodesTreeSettings.subtreeSettings.parentTabNodeDraggingActionModifierKeysMappings),get expandCollapseClickActionSettings(){return i.store.getState().options.nodesTreeSettings.subtreeSettings.expandOrCollapseClickActionSettings},useExpandCollapseClickActionSettings:()=>(0,i.t)(e=>e.options.nodesTreeSettings.subtreeSettings.expandOrCollapseClickActionSettings)},groupNodeSettings:{get createNewTabNodeButtonPositionModifierKeysMappings(){return i.store.getState().options.nodesTreeSettings.groupNodeSettings.createNewTabNodeButtonPositionModifierKeysMappings},useCreateNewTabNodeButtonPositionModifierKeysMappings:()=>(0,i.t)(e=>e.options.nodesTreeSettings.groupNodeSettings.createNewTabNodeButtonPositionModifierKeysMappings),get expandCollapseClickActionSettings(){return i.store.getState().options.nodesTreeSettings.groupNodeSettings.expandOrCollapseClickActionSettings},useExpandCollapseClickActionSettings:()=>(0,i.t)(e=>e.options.nodesTreeSettings.groupNodeSettings.expandOrCollapseClickActionSettings)},branchTabNodeSettings:{get createNewTabNodeButtonPositionModifierKeysMappings(){return i.store.getState().options.nodesTreeSettings.branchTabNodeSettings.createNewTabNodeButtonPositionModifierKeysMappings},useCreateNewTabNodeButtonPositionModifierKeysMappings:()=>(0,i.t)(e=>e.options.nodesTreeSettings.branchTabNodeSettings.createNewTabNodeButtonPositionModifierKeysMappings)},get newTabNodePositionNewPageByOpenerTabSetting(){return i.store.getState().options.nodesTreeSettings.newTabNodePositionNewPageByOpenerTabSetting},useNewTabNodePositionNewPageByOpenerTabSetting:()=>(0,i.t)(e=>e.options.nodesTreeSettings.newTabNodePositionNewPageByOpenerTabSetting),get newTabNodePositionByOpenerTabSetting(){return i.store.getState().options.nodesTreeSettings.newTabNodePositionByOpenerTabSetting},useNewNodeTabPositionByOpenerTabSetting:()=>(0,i.t)(e=>e.options.nodesTreeSettings.newTabNodePositionByOpenerTabSetting),get newTabNodePositionExternalLinkSetting(){return i.store.getState().options.nodesTreeSettings.newTabNodePositionExternalLinkSetting},useNewTabNodePositionExternalLinkSetting:()=>(0,i.t)(e=>e.options.nodesTreeSettings.newTabNodePositionExternalLinkSetting),get newTabNodePositionBookmarkSetting(){return i.store.getState().options.nodesTreeSettings.newTabNodePositionBookmarkSetting},useNewTabNodePositionBookmarkSetting:()=>(0,i.t)(e=>e.options.nodesTreeSettings.newTabNodePositionBookmarkSetting),get activateNewTabOpenedFromBookmarkSetting(){return i.store.getState().options.nodesTreeSettings.activateNewTabOpenedFromBookmark},useActivateNewTabOpenedFromBookmarkSetting:()=>(0,i.t)(e=>e.options.nodesTreeSettings.activateNewTabOpenedFromBookmark),get dropTabNodeOntoTabNodePositionSetting(){return i.store.getState().options.nodesTreeSettings.dropTabNodeOntoTabNodePositionSetting},useDropTabNodeOntoTabNodePositionSetting:()=>(0,i.t)(e=>e.options.nodesTreeSettings.dropTabNodeOntoTabNodePositionSetting),get whichTabNodeToActivateAfterTabNodeClosedSettings(){return i.store.getState().options.nodesTreeSettings.whichTabNodeToActivateAfterTabNodeClosedSettings},useWhichTabNodeToActivateAfterTabNodeClosedSettings:()=>(0,i.t)(e=>e.options.nodesTreeSettings.whichTabNodeToActivateAfterTabNodeClosedSettings,{equalityFn:(e,t)=>(0,h.r$)(e,t,{ifPrint:!0,logTags:"storeManager.useWhichTabNodeToActivateAfterTabNodeClosedSettings"})}),get performanceSettings(){return i.store.getState().options.nodesTreeSettings.performanceSettings},usePerformanceSettings:(e=!1)=>(0,i.t)(e=>e.options.nodesTreeSettings.performanceSettings,{equalityFn:(t,n)=>(0,h.r$)(t,n,{ifPrint:e,logTags:"storeManager.usePerformanceSettings"})})},get developerSettings(){return i.store.getState().options.developerSettings},useDeveloperSettings:()=>(0,i.t)(e=>e.options.developerSettings),setDeveloperSettings(e){i.store.dispatch((0,d.yd)(e))}},licenseCache:{useLicenseCache:()=>(0,i.t)(e=>e.licenseCache),get licenseCache(){return i.store.getState().licenseCache},useLicenseCacheEntitlement:()=>(0,i.t)(e=>e.licenseCache.entitlement),useIsValidProEntitlement:()=>(0,i.t)(e=>(0,u.xd)(e.licenseCache)),get isValidProEntitlement(){return(0,u.xd)(i.store.getState().licenseCache)},setLicenseCache(e){i.store.dispatch((0,g.ek)(e))},async loadLicenseIntoCacheFromStorage(){await i.store.dispatch((0,g.Fw)())}},debug:{get isDebugMode(){return i.store.getState().debug.isDebugMode},useIsDebugMode:()=>(0,i.t)(e=>e.debug.isDebugMode)}},T=N},56615:(e,t,n)=>{n.d(t,{Xn:()=>i,fL:()=>g,getChromeCurrentWindowId:()=>s,hs:()=>c,mR:()=>b});var o=n(93034);async function i(e){let t=Array.isArray(e)?e:[e];await chrome.tabs.remove(t)}async function a(e,t,n){let o=getLogger(!0,LogTagStyleType.script,a.name);o.gP({movingTabs:e,toIndex:t}),n&&store.chromeEventListeners.toggleAllListeners(!1);try{let n=e.filter(e=>e.index<t).length;for(let i=0;i<e.length;i++){let a=e[i],r=t;a.index<t?(o.log(`Fix moving tab downwards tab will be removed first causing 1 index less in total. movingTabNode.index(${a.index}) < toIndex(${t}), fix ToIndex by toIndex - 1 (${t-1})`),r-=1):r+=i-n,await chrome.tabs.move(a.id,{index:r})}}catch(e){o.errorP(e)}finally{n&&store.chromeEventListeners.toggleAllListeners(!0),o.ge()}}async function r(){try{return await chrome.windows.getCurrent()}catch(e){throw Error(`getChromeCurrentWindow error:. Unable to get current window. Error: ${e.message}`)}}async function s(){try{return(await r()).id}catch(e){throw Error(`getChromeCurrentWindowId error: Unable to get current window id. Error: ${e.message}`)}}async function d(e){let t=(0,o.tZ)(!1,o.W4.script,d.name);t.gP({windowId:e});try{if(e||(t.log("Window is undefined. Get current window id."),e=await s()),!e)throw Error("windowId is undefined.");let n=await chrome.tabs.query({windowId:e});return t.log({chromeTabs:n}),n}catch(e){throw e}finally{t.ge()}}async function l(e){let t=(0,o.tZ)(!1,o.W4.script,l.name);t.gP({windowId:e});try{if(e||(t.log("Window is undefined. Get current window id."),e=await s()),!e)throw Error("windowId is undefined.");let n=await chrome.tabGroups.query({windowId:e});return t.log({chromeGroups:n}),n}catch(e){throw e}finally{t.ge()}}async function c(e){return await Promise.all([d(e),l(e)]).then(([e,t])=>({chromeTabs:e,chromeTabGroups:t}))}async function g(e){return(await chrome.windows.getAll()).some(t=>t.id===e)}n(53775),n(87521),n(3022),n(92935),n(24817),n(53233),n(37390),n(57866);var u=function(e){return e.ReplaceNewPageTabWithExtensionPageTabAtBottom="ReplaceNewPageTabWithExtensionPageTabAtBottom",e.ReplaceNewPageTabWithExtensionPageTab="ReplaceNewPageTabWithExtensionPageTab",e.RestoreExtensionTabAtOriginalIndex="RestoreExtensionTabAtOriginalIndex",e}(u||{});function p(e){return e.groupId!==chrome.tabGroups.TAB_GROUP_ID_NONE}function b(e,t){var n,o,i;return null!==(i=(null===(n=e.url)||void 0===n?void 0:n.startsWith(t))||(null===(o=e.pendingUrl)||void 0===o?void 0:o.startsWith(t)))&&void 0!==i&&i}},53775:(e,t,n)=>{n(94475),n(24817),n(79868)},67272:(e,t,n)=>{n.d(t,{ga:()=>l});var o=n(2530);n(65640);var i=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&0>t.indexOf(o)&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,o=Object.getOwnPropertySymbols(e);i<o.length;i++)0>t.indexOf(o[i])&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]]);return n};let a=(o.A.isDev,"G-9Y2L8DFZ4D"),r=(o.A.isDev,"nJ7bIg6kTs-IOn6UhZxthg"),s=function(e){return e.TEST="test",e.PAGE_VIEW="page_view",e.EXTENSION_ERROR="extension_error",e.LICENSE_VALIDATION_FAILURE="license_validation_failure",e.DEACTIVATE_A_DEVICE="deactivate_a_device",e.UNEXPECTED_EVENT_WITHOUT_PRO_ENTITLEMENT="unexpected_event_without_pro_entitlement",e}({});var d=function(e){return e.EXCEPTION="EXCEPTION",e.UNEXPECTED_BEHAVIOR="UNEXPECTED_BEHAVIOR",e}(d||{});let l=new class{constructor(e=!1){this.debug=e}async getOrCreateClientId(){let{clientId:e}=await chrome.storage.local.get("clientId");return e||(e=crypto.randomUUID(),await chrome.storage.local.set({clientId:e})),e}async getOrCreateSessionId(){let{sessionData:e}=await chrome.storage.session.get("sessionData"),t=Date.now();return e&&e.timestamp&&((t-parseInt(e.timestamp))/6e4>30?e=void 0:(e.timestamp=t.toString(),await chrome.storage.session.set({sessionData:e}))),e||(e={session_id:t.toString(),timestamp:t.toString()},await chrome.storage.session.set({sessionData:e})),e.session_id}async fireEvent(e,t={}){t.session_id||(t.session_id=await this.getOrCreateSessionId()),t.engagement_time_msec||(t.engagement_time_msec=100);try{if(await fetch(`${this.debug?"https://www.google-analytics.com/debug/mp/collect":"https://www.google-analytics.com/mp/collect"}?measurement_id=${a}&api_secret=${r}`,{method:"POST",body:JSON.stringify({client_id:await this.getOrCreateClientId(),events:[{name:e,params:t}]})}),!this.debug)return}catch(e){}}async fireEvent2(e){let{name:t}=e,n=i(e,["name"]);await this.fireEvent(t,n)}async firePageViewEvent(e,t,n={}){return this.fireEvent(s.PAGE_VIEW,Object.assign({page_title:e,page_location:t},n))}async fireUnexpectedBehaviorErrorEvent(e,t={}){return this.fireErrorEvent(Object.assign(Object.assign({},e),{type:d.UNEXPECTED_BEHAVIOR}),t)}async fireExceptionEvent(e,t={}){return this.fireErrorEvent(Object.assign(Object.assign({},e),{type:d.EXCEPTION}),t)}async fireErrorEvent(e,t={}){return this.fireEvent(s.EXTENSION_ERROR,Object.assign(Object.assign({},e),t))}}(o.A.isDev)},83246:(e,t,n)=>{n.d(t,{t2:()=>v,xd:()=>L});var o=n(69173),i=n(68928),a=n.n(i),r=n(31997),s=n.n(r),d=n(60047),l=n.n(d),c=n(2530),g=n(84590),u=n(67272),p=n(43393),b=n(87521),h=n(44788),N=n(93034),T=n(54510),S=n(61566),f=n(27566),C=n(78154);n(35904);var m=n(94778),y=n(6320),A=n(37390),w=n(59721);async function v(){return await I(window.location.pathname)}async function I(e,t=!1){let n;let i=(0,N.tZ)(c.A.logLicenseValidation,N.W4.script,[...(0,A.eC)(e),I.name]);i.gP("Get license data from Chrome local storage.");try{let e=await T.g.loadData();if(i.log("Encrypted license data retrieved from Chrome local storage.",{encryptedLicenseData:e}),e){let t;if(t=await (0,S.af)(e))try{n=JSON.parse(t)}catch(e){i.error("Unable to convert license data to JSON. Data might be broken.",e)}}}catch(n){let e="Failed to decrypt license data. It might be compromised.";if(await u.ga.fireExceptionEvent({from:"service worker",when:"Decrypt license data.",details:e,error:n.message}),i.error(e,n),t)throw n}finally{i.ge()}return n||(n=function(e){return{deviceId:null!=e?e:(0,o.Ak)(),entitlement:g.h.FREE}}(),await E(e,n)),n}async function E(e,t){let n=(0,N.tZ)(c.A.logLicenseValidation,N.W4.script,[...(0,A.eC)(e),E.name]);n.gP("Saving license. Disable listener to avoid dead loops or unexpected behavior.",t);try{await f.X7.disableListener(C.HR.SERVICE_WORKER),await f.F2.disableListener(C.x7.SERVICE_WORKER);let o=await (0,S.yv)(JSON.stringify(t));await T.g.save(o),n.log("License data encrypted and saved to Chrome storage."),await P(e,t),L(t)||(n.log("License is not pro, disable PRO features."),await O())}catch(e){n.error("Save license data error.",e)}finally{n.ge(),await f.X7.enableListener(C.HR.SERVICE_WORKER),await f.F2.enableListener(C.x7.SERVICE_WORKER)}}async function P(e,t){let n=(0,N.tZ)(c.A.logLicenseValidation,N.W4.script,[...(0,A.eC)(e),P.name]);n.gP("Notify license changes.",t);try{(0,A.SR)()||b.store.licenseCache.setLicenseCache(t),n.log("Send a message to notify pages to update license cache."),await (0,h.w)({type:"setLicenseCacheState",license:t},{logTags:e,onLogFailure:()=>n.falseP("No active listeners.")})}catch(e){n.error("Notify license changes.",e)}finally{n.ge()}}async function O(){await m.O.updateOptions(e=>{x(e)}),await (0,h.w)({type:"previewNodesTheme",previewNodesTheme:void 0})}async function x(e){let t=(0,N.tZ)(c.A.logLicenseValidation,N.W4.script,[x.name]);if(Object.isFrozen(e))return t.errorP("Options is frozen. Cannot update."),!1;let n=!1;return e.themeSettings.customizedTabNodesTreeThemeSettings.enabled&&(e.themeSettings.customizedTabNodesTreeThemeSettings.enabled=!1,n=!0),e.nodesTreeSettings.newTabNodePositionExternalLinkSetting!==w.qS.ChromeDefault&&(e.nodesTreeSettings.newTabNodePositionExternalLinkSetting=w.qS.ChromeDefault,n=!0),e.nodesTreeSettings.newTabNodePositionBookmarkSetting!==w.B8.ChromeDefault&&(e.nodesTreeSettings.newTabNodePositionBookmarkSetting=w.B8.ChromeDefault,n=!0),e.nodesTreeSettings.whichTabNodeToActivateAfterTabNodeClosedSettings.settingType!==y.WQ.ChromeDefault&&(e.nodesTreeSettings.whichTabNodeToActivateAfterTabNodeClosedSettings.settingType=y.WQ.ChromeDefault,n=!0),n}function L(e){var t;let n;return t=g.h.PRO,n=!1,t===g.h.PRO&&e.entitlement===g.h.PRO&&(n=!0),n&&!!e.status&&[p.UI.ACTIVE,p.UI.EXPIRING].includes(e.status)}n(65640),a().extend(s()),a().extend(l())},2613:(e,t,n)=>{n(93034),n(24817)},24508:(e,t,n)=>{n(56615),n(93034),n(37390),n(3735),n(44788)},24817:(e,t,n)=>{n.d(t,{IB:()=>O,IC:()=>w,LD:()=>S,Op:()=>f,SQ:()=>x,Sh:()=>b,UW:()=>y,Z0:()=>p,aL:()=>A,fc:()=>l,gJ:()=>C,j7:()=>h,mc:()=>I,nJ:()=>u,q8:()=>E,u:()=>c,uW:()=>v,um:()=>P,y7:()=>m,zv:()=>T});var o=n(2531),i=n(37390);n(2613);var a=n(3022),r=n(93034),s=n(2530),d=n(56615);function l(e){return e.filter(e=>E(e))}function c(e,t){let n=(0,r.tZ)(!1,r.W4.script);n.gt({nodes:(0,r.mm)(e)});let o=l(e);o.reduce((e,n,i,a)=>((function e(t,n,o,i){var a,s;let l=(0,r.tZ)((0,d.mR)(n,"https://www.reddit.com/r/cats/")&&!0,r.W4.script,[e.name]);l.gP("Loop above nodes until nodeIndex < 0, or found first ancestor, and include it and its ancestralNodeIds as tabNode's ancestralNodeIds",{"tabNode.title":n.title,"tabNode.index":o,tabNode:(0,r.mm)(n)});let c=o-1,u=n.ancestralNodeIds.slice(),p=()=>{l.update({from:u,to:n.ancestralNodeIds})};if(c<0)l.start(`currentNodeIndex(${c}) < 0. This means this tab node is the top node in the tree. tabNode.ancestralNodeIds should be empty. Check it.`),u.length>0?(l.check("tabNode.ancestralNodeIds is not empty. Empty it."),n.ancestralNodeIds=[],g(t,n),p()):l.false("tabNode.ancestralNodeIds is empty. Do nothing.");else{l.gls("Start to check tab node above it.");let e=!1;for(;c>=0;){let o=t[c];l.start("currentNode",{currentNodeIndex:c,"currentTabNode.title":o.title,currentTabNode:(0,r.mm)(o)});let d=o.groupId!==chrome.tabGroups.TAB_GROUP_ID_NONE,u=n.groupId!==chrome.tabGroups.TAB_GROUP_ID_NONE;if(d&&!u){e||0===n.ancestralNodeIds.length||(l.check("currentTabNode is in a group, but tabNode is not in a group, empty tabNode.ancestralNodeIds."),n.ancestralNodeIds=[],g(t,n),p()),l.stop("End.");break}if(!d&&u){e||0===n.ancestralNodeIds.length||(l.check("currentTabNode is not in a group, but tabNode is in a group, empty tabNode.ancestralNodeIds."),n.ancestralNodeIds=[],g(t,n),p()),l.stop("End.");break}if(d&&u&&o.groupId!==n.groupId){e||0===n.ancestralNodeIds.length||(l.check("currentTabNode is in a group, but tabNode is not in the same , empty tabNode.ancestralNodeIds."),n.ancestralNodeIds=[],g(t,n),p()),l.stop("End.");break}if(!e){let r=n.ancestralNodeIds.includes(null!==(a=o.previousTabId)&&void 0!==a?a:-1);if(o.id&&n.ancestralNodeIds.includes(o.id)||r){let a=n.ancestralNodeIds[0]!==o.id;r?l.check("currentTabNode is an ancestor of tabNode by its previousTabId. Check if tabNode is first child and promoteFirstChildAsParentOnParentClose setting.",{promoteFirstChildAsParentOnParentClose:i}):l.check("currentTabNode is an ancestor of tabNode. Check if tabNode is first child and promoteFirstChildAsParentOnParentClose setting.",{promoteFirstChildAsParentOnParentClose:i});let s=!1;if(i){l.check("promoteFirstChildAsParentOnParentClose is true, check if the first tab node below currentTabNode is new child node.");let e=c+1;if(e!==n.index&&e<t.length){let i=t[e];C(i)<C(n)&&i.ancestralNodeIds.includes(o.id)&&(n.ancestralNodeIds=[i.id,...i.ancestralNodeIds],s=!0)}}if(s||(n.ancestralNodeIds=[o.id,...o.ancestralNodeIds]),a&&g(t,n),p(),!i){l.stop("End.");break}e=!0}}if((o.directChildrenNodeIds.includes(n.id)||o.directChildrenNodeIds.includes(null!==(s=n.previousTabId)&&void 0!==s?s:-1))&&n.ancestralNodeIds[0]!==o.id){l.check("currentTabNode is the direct parent of tabNode, but not in tabNode.ancestralNodeIds. Update tabNode.ancestralNodeIds with currentTabNode and its ancestralNodeIds."),n.ancestralNodeIds=[o.id,...o.ancestralNodeIds],p(),l.stop("End.");break}if(0===o.ancestralNodeIds.length){e||!(n.ancestralNodeIds.length>0)||n.ancestralNodeIds.includes(o.id)||(l.check("'currentTabNode is at root level, but it is not in tabNode.ancestralNodeIds. All tab node's ancestors are gone. Empty tabNode.ancestralNodeIds'"),n.ancestralNodeIds=[],g(t,n),p()),l.stop("Reach first root level currentTabNode. End.");break}--c<0&&(e||(l.check(`nodeIndex(${c}) < 0, could not find any the parent. Empty "tabNode.ancestralNodeIds".`),n.ancestralNodeIds=[],p()),l.stop("End."))}l.ge()}l.end("fixTabNodeMissingAncestors complete"),l.ge()})(o,n,i,t),e),e),n.ge()}function g(e,t){let n=(0,r.tZ)(!1,r.W4.script,g.name);if(n.gP(),n.search(`Check if tabNode is collapsed, we have to expand it: ${t.areChildrenExpanded?" and all it descendants":""}, otherwise there will be no way to do it since parent is missing.`),t.isExpanded){n.false("tabNode is already expanded. Do nothing.");return}n.check("tabNode is collapsed. Expand it."),t.isExpanded=!0,n.update("tabNode and its updated to collapsed."),function e(t,n,o){(0,r.tZ)(!1,r.W4.script,e.name).log(`${t?"Expand":"Collapse"} tabNode descendants.`),o.areChildrenExpanded=t,n.filter(e=>e.ancestralNodeIds.includes(o.id)).forEach(e=>{e.isExpanded=t})}(t.areChildrenExpanded,e,t),n.ge()}function u(e){return e.index+e.descendantNodesCount+1}function p(e,t){let n=e.index+1;for(;n<t.length;){let e=function(e,t,n=!1){return N(t,t=>t.index===e,n)}(n,t);if(!e||0===C(e))break;n++}return n}function b(e,t,n=!1){let o=e.findIndex(e=>e.id===t);if(-1!==o){let t=e[o];return -1!==o&&n&&e.splice(o,1),t}}function h(e,t,n=!1){let o=e.findIndex(e=>"groupNode"===e.nodeType&&e.id===t);if(-1!==o){let t=e[o];return n&&e.splice(o,1),t}}function N(e,t,n=!1){let o=e.findIndex(e=>E(e)&&t(e));if(-1!==o){let t=e[o];return -1!==o&&n&&e.splice(o,1),t}}function T(e,t,n=!1){return N(t,t=>t.id===e,n)}function S(e,t){return null==e?void 0:e.map(e=>{let n=structuredClone(e);return null==t||t(n),n})}function f(e,t){return s.A.disableLogger?e:S(e,t)}function C(e){return e.ancestralNodeIds.length}function m(e){return(null==e?void 0:e.groupId)!==chrome.tabGroups.TAB_GROUP_ID_NONE}function y(e,t){return e.ancestralNodeIds.includes(t.id)}function A(e,t){let n;let a=(0,r.tZ)(!1,r.W4.script,"updateByTabNodeSelfProperties");a.gP({updatingTabNode:e,partialProperties:t});let s=E(e)?o.Wf:function(e){return(null==e?void 0:e.nodeType)==="groupNode"}(e)?o.WL:void 0;if(s){for(n in t){if(!s.includes(n))continue;let o=(0,i.nH)(e,n),r=Object.getOwnPropertyDescriptor(e,n);a.log({key:n,desc:r,isWritable:o}),o&&(e[n]=t[n])}a.ge()}}function w(e){return Object.assign(Object.assign({},e),{directChildrenNodeIds:[],areChildrenExpanded:!0,isExpanded:!0})}function v(e,t,n){let{includeAncestorNode:o}=n;return e.filter(e=>E(e)&&(e.ancestralNodeIds.includes(t)||!!o&&e.id===t))}function I(e){var t,n;return E(e)&&null!==(n=null===(t=e.url)||void 0===t?void 0:t.startsWith(a.F1))&&void 0!==n&&n}function E(e){return(null==e?void 0:e.nodeType)==="tabNode"}function P(e,t){return t.find(t=>t.id===e.directChildrenNodeIds[0])}function O(e,t){return t.findLast(t=>E(t)&&t.groupId===e.id)}function x(e,t){return e.map(e=>{for(let n=0;n<t.length;n++)e=t[n](e);return e})}}}]);