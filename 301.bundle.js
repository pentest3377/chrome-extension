"use strict";(self.webpackChunktab_nodes_tree_extension=self.webpackChunktab_nodes_tree_extension||[]).push([[301],{57866:(e,t,a)=>{a.d(t,{B:()=>i});let i=function(e){return e.ANY="ANY",e.TAB_CREATED="TAB_CREATED",e.TAB_UPDATED="TAB_UPDATED",e.TAB_REMOVED="TAB_REMOVED",e.TAB_MOVED="TAB_MOVED",e.TAB_ACTIVATED="TAB_ACTIVATED",e.TAB_REPLACED="TAB_REPLACED",e.TAB_ATTACHED="TAB_ATTACHED",e.TAB_DETACHED="TAB_DETACHED",e.TAB_GROUP_CREATED="TAB_GROUP_CREATED",e.TAB_GROUP_UPDATED="TAB_GROUP_UPDATED",e.TAB_GROUP_REMOVED="TAB_GROUP_REMOVED",e.TAB_GROUP_MOVED="TAB_GROUP_MOVED",e}({})},875:(e,t,a)=>{a.d(t,{b:()=>i});let i="SW"},51209:(e,t,a)=>{a.d(t,{J:()=>n});var i=a(93034),s=a(44788);async function n(e,t){let a=(0,i.tZ)(!0,i.W4.message,[...null!=t?t:[],n.name]);if(!e){a.end("Target windowId is undefined.");return}return await (0,s.w)({type:"probeSidePanelOpen",windowId:e},{logTags:t,onLogFailure:e=>a.warnP("Unable to send message. This could be due to none side panel is opened in all windows.",e)})}},2531:(e,t,a)=>{a.d(t,{Cg:()=>d,L5:()=>o,WL:()=>r,Wf:()=>n});let i={isExpandingOrCollapsing:!1,isExpanded:!0,areChildrenExpanded:!0,directChildrenNodeIds:[],childrenIds:{},descendantNodesCount:0},s=Object.assign(Object.assign({},i),{nodeType:"tabNode",isRead:!1,indexInGroup:void 0,isFirstTabNodeInGroup:!1,isLastTabNodeInGroup:!1,isFirstTabNodeAfterGroup:!1,isFirstNonPinnedTabNodeInTree:!1,isGroupExpanded:void 0,isLastTabNodeInTree:!1,isLastPinnedTabInTree:!1,isSelected:!1,ancestralNodeIds:[],previousTabId:null,parentTabId:null}),n=Object.keys(s);function o(e,t){var a,i;return Object.assign(Object.assign(Object.assign({},s),t),{uuid:e,id:null!==(a=t.id)&&void 0!==a?a:chrome.tabs.TAB_ID_NONE,title:null!==(i=t.title)&&void 0!==i?i:"",isRead:t.active,zIndex:0})}let r=Object.keys(Object.assign(Object.assign({},i),{nodeType:"groupNode",icon:void 0}));function d(e,t){var a,s;return Object.assign(Object.assign(Object.assign({nodeType:"groupNode"},i),t),{uuid:e,id:null!==(a=t.id)&&void 0!==a?a:chrome.tabGroups.TAB_GROUP_ID_NONE,title:null!==(s=t.title)&&void 0!==s?s:"",icon:void 0,zIndex:0})}},53233:(e,t,a)=>{var i=a(56615);a(24508),a(2613);var s=a(51209),n=a(11080),o=a(92935);a(87855);var r=a(93034),d=a(37390);a(57866);var l=a(3735);a(1581),a(3022);let c=(0,r.tZ)(!0,r.W4.chromeEvent,[(0,d.SG)()]),g=((0,o.debounce)(async e=>{await u(e)},500),new Map);async function u(e,t){let a=(0,r.tZ)(!0,r.W4.script,[...c.prefixTags,u.name,`wid:${e}`]);a.logP("Sync nodes tree data in storage.",{windowId:e});try{if(a.logP("Checking whether side panel is opened.",{windowId:e}),await (0,s.J)(e,c.prefixTags)){a.endP("Side panel is open. It accounts for events. Don't need to sync.");return}let o=await l.L.load(e);if(!o){a.endP(`Cannot find tree data/tree nodes with id '${e}'. Nothing to sync.`);return}if(!await (0,i.fL)(e)){a.endP(`Cannot find window with id '${e}'. This could be due to window is closed already. We cannot get tabs to sync.`);return}let r=await chrome.tabs.query({windowId:e});if(0===r.length){a.endP("No tabs. Nothing to sync");return}a.logP("Getting new nodes with build nodes tree and update tree data in storage.");let d=await (0,n.d)(Object.assign(Object.assign({},t),{oldNodes:o,chromeGroupsAndTabs:await (0,i.hs)(e),fixMissingParents:!0}));await l.L.save({windowId:e,treeNodes:d})}catch(e){a.error(e)}}},84200:(e,t,a)=>{a(93034)},59721:(e,t,a)=>{a.d(t,{$K:()=>l,B8:()=>d,FR:()=>n,Ic:()=>i,O8:()=>o,Tw:()=>s,qS:()=>r});let i=function(e){return e.CloseParentTabNode="CloseParentTabNode",e.CloseParentTabNodeAndChildren="CloseParentTabNodeAndChildren",e}({}),s=function(e){return e.DragWholeSubTree="DragWholeSubTree",e.DragParentTabNode="DragParentTabNode",e}({}),n=function(e){return e.ChromeDefault="ChromeDefault",e.NextRootOfActiveTabNode="NextRootOfActiveTabNode",e.NextSiblingOfActiveTabNode="NextSiblingOfActiveTabNode",e}({}),o=function(e){return e.ChromeDefault="ChromeDefault",e.FirstChildOfActiveTabNode="FirstChildOfActiveTabNode",e.LastChildOfActiveTabNode="LastChildOfActiveTabNode",e}({}),r=function(e){return e.ChromeDefault="ChromeDefault",e.NextRootOfActiveTabNode="NextRootOfActiveTabNode",e.NextSiblingOfActiveTabNode="NextSiblingOfActiveTabNode",e.FirstChildOfActiveTabNode="FirstChildOfActiveTabNode",e.LastChildOfActiveTabNode="LastChildOfActiveTabNode",e}({}),d=function(e){return e.ChromeDefault="ChromeDefault",e.NextRootOfActiveTabNode="NextRootOfActiveTabNode",e.NextSiblingOfActiveTabNode="NextSiblingOfActiveTabNode",e.FirstChildOfActiveTabNode="FirstChildOfActiveTabNode",e.LastChildOfActiveTabNode="LastChildOfActiveTabNode",e}({}),l=function(e){return e.FirstChild="FirstChild",e.LastChild="LastChild",e}({})},83840:(e,t,a)=>{a.d(t,{A:()=>i,C:()=>s});let i=function(e){return e.None="None",e.Shift="Shift",e.WinLinuxCtrlOrMacCmd="WinLinuxCtrlOrMacCmd",e.WinLinuxCtrlOrMacCmd_Shift="WinLinuxCtrlOrMacCmd_Shift",e.Alt="Alt",e.ALT_Shift="ALT_Shift",e.WinLinuxCtrlOrMacCmd_Alt="WinLinuxCtrlOrMacCmd_Alt",e.WinLinuxCtrlOrMacCmd_ALT_Shift="WinLinuxCtrlOrMacCmd_ALT_Shift",e}({}),s=function(e){return e.Single="Single",e.Double="Double",e}({})},54510:(e,t,a)=>{a.d(t,{g:()=>o});var i=a(62576),s=a(60624);class n extends i.wc{constructor(){super(...arguments),this.storageKey=s.A.License}get defaultData(){return""}async load(){return await this.loadData()}async save(e){await this.saveData(e)}}let o=new n(n.name)},35904:(e,t,a)=>{a.d(t,{k:()=>o});var i=a(62576),s=a(60624);class n extends i.wc{constructor(){super(...arguments),this.storageKey=s.A.LicenseAuth}get defaultData(){return{}}async load(){return await this.loadData()}async save(e){await this.saveData(Object.assign(Object.assign({},await this.loadData()),e))}}let o=new n(n.name)},94778:(e,t,a)=>{a.d(t,{O:()=>b});var i=a(62576),s=a(60624),n=a(78639),o=a(6320),r=a(93034),d=a(92935),l=a.n(d),c=a(37390),g=a(7426),u=a(83840);let p=(0,r.tZ)(!0,r.W4.storage,"OptionsStorage");class h extends i.wc{constructor(){super(...arguments),this.storageKey=s.A.Options,this.logTags="OptionsStorage"}get defaultData(){return n.K}async loadData(e){let t=await super.loadData(e);if(e.verifyDataIntegrity)try{p.gPT(this.loadData.name,"Load data and verify data integrity.",t);let e=!1,a=this.getFixDateIntegrityForWhichTabNodeToActivateAfterTabNodeClosedSettings(t.nodesTreeSettings.whichTabNodeToActivateAfterTabNodeClosedSettings);a&&((t=structuredClone(t)).nodesTreeSettings.whichTabNodeToActivateAfterTabNodeClosedSettings=a,e=!0),t.themeSettings.customizedTabNodesTreeThemeSettings.savedThemes.forEach(t=>{let a=(0,r.mm)(t);p.log("Fix customized theme data integrity",a);let i=(0,c.Jx)(g.qt,t,`theme(${t.name})`),s=(0,c.Gq)(i,a);Object.keys(s).length>0&&(p.log("Theme fixed.",{fixedCustomizedTheme:i,clonedTheme:a,differences:s}),e=!0)}),this.migrateCtrlModifierKeyCombinations(t)&&(e=!0),e?(p.end("Data integrity fixed. Save it.",t),await this.saveData(t)):p.end("Data integrity is valid.")}catch(e){p.error(e)}finally{p.ge()}return t}async updateOptions(e){let t=structuredClone(await b.loadData({verifyDataIntegrity:!1}));e(t),this.logger.logPT(this.updateOptions.name,{options:t}),await this.saveData(t)}migrateCtrlModifierKeyCombinations(e){let t=(0,r.tZ)(!1,r.W4.script,this.migrateCtrlModifierKeyCombinations.name);t.gP({options:e});let a=!1;try{function i(e,i,s){let n;for(let[o,d]of Object.entries(e))!(0,c.GG)(d,u.A)&&(t.failure(`${o} modifier key combination is not valid.`,{key:o,value:d}),i[o]&&(n||(n=Object.assign({},e)),n[o]=i[o],a=!0,t.check(`Invalid modifier key combinations fixed for "${s}" setting.`,{before:(0,r.mm)(i),after:(0,r.mm)(n)})));return null!=n?n:e}e.nodesTreeSettings.subtreeSettings.parentTabNodeCloseButtonActionModifierKeysMappings=i(e.nodesTreeSettings.subtreeSettings.parentTabNodeCloseButtonActionModifierKeysMappings,n.K.nodesTreeSettings.subtreeSettings.parentTabNodeCloseButtonActionModifierKeysMappings,"nodesTreeSettings.subtreeSettings.parentTabNodeCloseButtonActionModifierKeyMappings"),e.nodesTreeSettings.subtreeSettings.parentTabNodeDraggingActionModifierKeysMappings=i(e.nodesTreeSettings.subtreeSettings.parentTabNodeDraggingActionModifierKeysMappings,n.K.nodesTreeSettings.subtreeSettings.parentTabNodeDraggingActionModifierKeysMappings,"nodesTreeSettings.subtreeSettings.parentTabNodeDraggingActionModifierKeyMappings"),e.nodesTreeSettings.createNewTabNodeFixedButtonSettings.newTabNodePositionModifierKeysMappings=i(e.nodesTreeSettings.createNewTabNodeFixedButtonSettings.newTabNodePositionModifierKeysMappings,n.K.nodesTreeSettings.createNewTabNodeFixedButtonSettings.newTabNodePositionModifierKeysMappings,"nodesTreeSettings.createNewTabNodeFixedButtonSettings.newTabNodePositionModifierKeyMappings"),e.nodesTreeSettings.branchTabNodeSettings.createNewTabNodeButtonPositionModifierKeysMappings=i(e.nodesTreeSettings.branchTabNodeSettings.createNewTabNodeButtonPositionModifierKeysMappings,n.K.nodesTreeSettings.branchTabNodeSettings.createNewTabNodeButtonPositionModifierKeysMappings,"nodesTreeSettings.branchTabNodeSettings.createNewTabNodeButtonPositionModifierKeyMappings"),e.nodesTreeSettings.groupNodeSettings.createNewTabNodeButtonPositionModifierKeysMappings=i(e.nodesTreeSettings.groupNodeSettings.createNewTabNodeButtonPositionModifierKeysMappings,n.K.nodesTreeSettings.groupNodeSettings.createNewTabNodeButtonPositionModifierKeysMappings,"nodesTreeSettings.groupNodeSettings.createNewTabNodeButtonPositionModifierKeyMappings")}catch(e){t.error(e)}finally{t.ge()}return a}getFixDateIntegrityForWhichTabNodeToActivateAfterTabNodeClosedSettings(e){let t;let a=(0,r.tZ)(!1,r.W4.script,this.getFixDateIntegrityForWhichTabNodeToActivateAfterTabNodeClosedSettings.name);function i(a=!1){return a?(t||(t=structuredClone(e)),t):null!=t?t:e}a.gP({settings:e}),a.validate(" Ensure settingType is valid.",{settingsType:e.settingType}),(0,c.GG)(i().settingType,o.WQ)?a.check("Setting type is valid."):(a.log("Setting type is not valid. Set it to Chrome default."),(t=i(!0)).settingType=o.WQ.ChromeDefault);let s=Object.entries(o._3);if(a.validate("Ensure all rules condition is in the order.",{conditions:(0,r.mm)(s),settings:e,test:Object.create(o._3)}),e.rulesConditionOrder.forEach((e,n)=>{let o=s.findIndex(([t,a])=>e===a);-1!==o?s.splice(o,1):(a.failure("Rule condition is not valid. Remove it.",{value:e}),(t=i(!0)).rulesConditionOrder.splice(n,1))}),s.length>0?(a.failure("There are missing condition keys. Add them",{conditions:new Map(s)}),t=i(!0),s.forEach(([e,a])=>{t.rulesConditionOrder.push(a)})):a.check("rulesConditionOrder is valid."),l().last(i().rulesConditionOrder)!==o._3.WhenHasNeitherParentNorChildren){a.failure(`Last rule is not ${o._3.WhenHasNeitherParentNorChildren}. Move it to the last.`,{conditions:s});let e=(t=i(!0)).rulesConditionOrder.findIndex(e=>e===o._3.WhenHasNeitherParentNorChildren);-1!==e&&t.rulesConditionOrder.splice(e,1),t.rulesConditionOrder.push(o._3.WhenHasNeitherParentNorChildren)}else a.check('Last rule is "WhenHasNeitherParentNorChildren". Valid.');return a.log("Final rules order",{correctedSettings:t}),a.ge(),t}}let b=new h(h.name)},62576:(e,t,a)=>{a.d(t,{jY:()=>d,wc:()=>r});var i=a(60624),s=a(93034),n=a(37390),o=a(2530);class r{constructor(e){this.logTags=e,this.logger=(0,s.tZ)(!0,s.W4.storage,this.logTags)}get storageArea(){if(this.isLocalStorage(this.storageKey))return"local";if(this.isSessionStorage(this.storageKey))return"session";throw Error(`Unknown storage key: ${this.storageKey}`)}isLocalStorage(e){return Object.values(i.A).includes(e)}isSessionStorage(e){return Object.values(i.B).includes(e)}async saveData(e,t=this.storageKey){switch(this.storageArea){case"local":await d.save(t,e);break;case"session":await l.save(t,e);break;default:throw Error(`Unsupported storage area: ${this.storageArea}`)}await d.save(t,e)}async loadData(e={}){var t,a;let i;let{verifyDataIntegrity:s=!1,storageKey:r=this.storageKey}=e;switch(this.storageArea){case"local":i=null!==(t=await d.load(r))&&void 0!==t?t:structuredClone(this.defaultData);break;case"session":i=null!==(a=await l.load(r))&&void 0!==a?a:structuredClone(this.defaultData);break;default:throw Error(`Unsupported storage area: ${this.storageArea}`)}if(s){this.logger.logP("verifyDataIntegrity flag is true, verify data.",i);let e=(0,n.Jx)(this.defaultData,structuredClone(i),"");if(JSON.stringify(e)!==JSON.stringify(i)){let t=o.A.isDev?(0,n.Gq)(i,e):void 0;this.logger.logP("Data has been fixed. Saved to storage.",{difference:t,data:i,clonedData:e}),await this.saveData(e),i=e}}return i}async removeData(e=this.storageKey){switch(this.storageArea){case"local":await d.remove(e);break;case"session":await l.remove(e);break;default:throw Error(`Unsupported storage area: ${this.storageArea}`)}}}class d{static async save(e,t){await chrome.storage.local.set({[e]:t})}static async load(e){return(await chrome.storage.local.get(e))[e]}static async remove(e){return await chrome.storage.local.remove(e)}}class l{static async save(e,t){await chrome.storage.session.set({[e]:t})}static async load(e){return(await chrome.storage.session.get(e))[e]}static async remove(e){return await chrome.storage.session.remove(e)}}},60624:(e,t,a)=>{a.d(t,{A:()=>i,B:()=>s});let i=function(e){return e.TreeNodes="treeNodes",e.TreeNodesInfoMap="treeNodesInfoMap",e.DitchedTreeNodes="ditchedTreeNodes",e.Options="options",e.LicenseAuth="licenseAuth",e.License="license",e}({}),s=function(e){return e.DELETE_ME="DELETE_ME",e}({})},3735:(e,t,a)=>{a.d(t,{L:()=>c});var i=a(62576),s=a(60624),n=a(93034),o=a(3022),r=a(37390),d=a(875);class l extends i.wc{constructor(e){super([...(0,r.eC)(e),l.name]),this.storageKey=s.A.TreeNodesInfoMap,this.logTags=e}getTreeNodesDataStorageKey(e){return l.TREE_NODES_DATA_PREFIX_KEY+e}async save(e){let{windowId:t,treeNodes:a}=e;await i.jY.load(s.A.TreeNodes)||await i.jY.remove(s.A.TreeNodes);let n=await this.loadData(),o=this.getTreeNodesDataStorageKey(t),r=new Date;n[t]={treeNodesDataStorageKey:o,treeNodesDataLastUpdatedTimestamp:r.getTime(),treeNodesDataLastUpdatedTimestampReadable:r.toISOString()};let d=this.trimTreeNodesInfoMapEntries(n);for(let e in await this.saveData(n),await i.jY.save(o,a),d){let t=d[e];await i.jY.remove(t.treeNodesDataStorageKey)}}get defaultData(){return{}}async load(e){try{if(!e)return;return await i.jY.load(this.getTreeNodesDataStorageKey(e))}catch(e){this.logger.error(e)}}trimTreeNodesInfoMapEntries(e){let t={};if(Object.keys(e).length>o.my){let a=Object.entries(e).sort(([,e],[,t])=>{var a,i;return(null!==(a=e.treeNodesDataLastUpdatedTimestamp)&&void 0!==a?a:0)-(null!==(i=t.treeNodesDataLastUpdatedTimestamp)&&void 0!==i?i:0)}),i=a.length-o.my;for(let s=0;s<i;s++){let[i,n]=a[s],o=parseInt(i);!isNaN(o)&&delete e[o]&&(t[o]=n)}}return t}async cleanUpTreeNodesDataOrphans(){let e=(0,n.tZ)(!0,n.W4.storage,[...this.logger.prefixTags,this.cleanUpTreeNodesDataOrphans.name]),t=await chrome.storage.local.get(),a=await this.loadData();for(let s in t){if(!s.startsWith(l.TREE_NODES_DATA_PREFIX_KEY))continue;let n=parseInt(s.replace(l.TREE_NODES_DATA_PREFIX_KEY,""));isNaN(n)||a[n]||(e.logP("Found orphan tree nodes data, remove it.",{treeNodesInfoMap:a,allChromeStorageData:t,key:s,windowId:n}),await i.jY.remove(s))}}}l.TREE_NODES_DATA_PREFIX_KEY="treeNodes_";let c=new l([...(0,r.SR)()?[d.b]:[]])},62567:(e,t,a)=>{a.d(t,{O:()=>n});var i=a(11080),s=a(87521);async function n(e){var t;let a=null!==(t=null==e?void 0:e.oldNodes)&&void 0!==t?t:s.store.nodesTree.nodes,n=await (0,i.d)(Object.assign(Object.assign({},e),{oldNodes:a}));s.store.nodesTree.setNodes(n,null==e?void 0:e.setNodesFirstLoaded)}},67426:(e,t,a)=>{a.d(t,{store:()=>y,t:()=>N});var i=a(69173),s=a(35497),n=a(69469),o=a(59),r=a(20768),d=a(80363),l=a(36840),c=a(41861),g=a(50996),u=a(7136),p=a(57875),h=a(70449),b=a(9727),T=a(41058),f=a(14207);let y=(0,i.U1)({reducer:{nodesTree:n.Ay,popupMenu:s.A,dialogs:h.Ay,message:f.A,chromeEventListeners:o.Ay,chromeStorageChangeListeners:r.Ay,windowLocalStorageEventListeners:d.Ay,options:l.Ay,licenseCache:c.Ay,debug:b.A},middleware:e=>e({serializableCheck:!1}).concat(g.B).concat(u.P).concat(T.N),enhancers:[]}),N=p.d4},7136:(e,t,a)=>{a.d(t,{P:()=>n});var i=a(93034);let s=(0,i.tZ)(!1,i.W4.state,"loggerMiddleware"),n=()=>e=>t=>{var a;s.gPT(t.type,{arg:null===(a=null==t?void 0:t.meta)||void 0===a?void 0:a.arg,payload:t.payload,action:t});let i=e(t);return s.log({result:i}),s.ge(),i}},41058:(e,t,a)=>{a.d(t,{N:()=>n});var i=a(93034);let s=(0,i.tZ)(!1,i.W4.state,"persistMiddleware"),n=()=>e=>t=>{var a;s.gPT(t.type,{arg:null===(a=null==t?void 0:t.meta)||void 0===a?void 0:a.arg,payload:t.payload,action:t});let i=e(t);return s.log(i),s.ge(),i}},50996:(e,t,a)=>{a.d(t,{B:()=>i});let i=()=>e=>t=>{let a=e(t);if(null==t?void 0:t.error)throw t.error;return a}},59:(e,t,a)=>{a.d(t,{Ay:()=>p,Kn:()=>u,bh:()=>g});var i=a(69173),s=a(28017),n=a(67426),o=a(57866),r=a(93034);let d=(0,r.tZ)(!0,r.W4.state,"chromeListenersReducer");(0,s.IP)();let l={disabledListeners:new Set},c=(0,i.Z0)({name:"chromeEventListeners",initialState:l,reducers:{toggleListeners:(e,t)=>{d.logPT("toggleListeners",{enabled:t.payload.enabled,listeners:t.payload.listeners});let a=Array.isArray(t.payload.listeners)?t.payload.listeners:[t.payload.listeners];t.payload.enabled?a.forEach(t=>e.disabledListeners.delete(t)):a.forEach(t=>e.disabledListeners.add(t))}}}),g=e=>n.store.getState().chromeEventListeners.disabledListeners.has(e)||n.store.getState().chromeEventListeners.disabledListeners.has(o.B.ANY),{toggleListeners:u}=c.actions,p=c.reducer},20768:(e,t,a)=>{a.d(t,{Ay:()=>g,SE:()=>d,Wc:()=>l,dx:()=>c});var i=a(69173),s=a(28017),n=a(67426);(0,s.IP)();let o={disabledListenerIds:new Set},r=(0,i.Z0)({name:"chromeStorageChangeListeners",initialState:o,reducers:{enableListenerIds:(e,t)=>{t.payload.forEach(t=>e.disabledListenerIds.delete(t))},disableListenerIds:(e,t)=>{t.payload.forEach(t=>e.disabledListenerIds.add(t))}}}),d=e=>n.store.getState().chromeStorageChangeListeners.disabledListenerIds.has(e),{enableListenerIds:l,disableListenerIds:c}=r.actions,g=r.reducer},9727:(e,t,a)=>{a.d(t,{A:()=>s});let i=(0,a(69173).Z0)({name:"debug",initialState:{isDebugMode:!0},reducers:{}}),{}=i.actions,s=i.reducer},70449:(e,t,a)=>{a.d(t,{Ay:()=>o,Yn:()=>n,q:()=>s});let i=(0,a(69173).Z0)({name:"dialogs",initialState:{dialogState:void 0,groupNodeConfigDialog:void 0},reducers:{setDialogState:(e,t)=>{e.dialogState=t.payload},setGroupNodeConfigDialog:(e,t)=>{e.groupNodeConfigDialog=t.payload}}}),{setDialogState:s,setGroupNodeConfigDialog:n}=i.actions,o=i.reducer},41861:(e,t,a)=>{a.d(t,{Ay:()=>g,Fw:()=>l,ek:()=>c});var i=a(69173),s=a(84590),n=a(83246),o=a(93034);(0,o.tZ)(!0,o.W4.state,"licenseCacheReducer");let r={entitlement:s.h.FREE},d=(0,i.Z0)({name:"licenseCacheState",initialState:r,reducers:{setLicenseCache:(e,t)=>t.payload},extraReducers:e=>{e.addCase(l.fulfilled,(e,t)=>{e.entitlement=t.payload.entitlement,e.status=t.payload.status})}}),l=(0,i.zD)("license/loadLicense",async()=>(0,n.t2)()),{setLicenseCache:c}=d.actions,g=d.reducer},14207:(e,t,a)=>{a.d(t,{A:()=>n,X:()=>s});let i=(0,a(69173).Z0)({name:"message",initialState:{message:void 0},reducers:{setMessageState:(e,t)=>{e.message=t.payload}}}),{setMessageState:s}=i.actions,n=i.reducer},69469:(e,t,a)=>{a.d(t,{Ay:()=>h,CU:()=>g,FQ:()=>l,RR:()=>p,an:()=>c,tx:()=>d,yO:()=>u});var i=a(69173),s=a(56615),n=a(3735),o=a(24817);let r=(0,i.Z0)({name:"nodesTree",initialState:{nodesDataLoaded:!1,treeFinishedInitialTransition:!1,nodes:[],styles:{essentialConstructTreeStyles:{tabNodeHeight:32,groupNodeHeight:32,tabNodeContentBorderWidth:0,pinnedTabNodeHeight:32,pinnedTabNodeWidth:32,pinnedTabNodeBorderWidth:1},tabNodeStyles:{nodesGap:0,collapsedMarginTop:0,expandedMarginTop:0},tabNodeStatusOpacityStyles:{unreadTabNodeTextOpacity:void 0,unreadTabNodeIconOpacity:void 0,unloadedTabNodeTextOpacity:void 0,unloadedTabNodeIconOpacity:void 0}}},reducers:{setSelectionStartTabId:(e,t)=>{e.selectionStartTabId=t.payload},setDraggingNode:(e,t)=>{e.draggingNode=t.payload},setNodes:(e,t)=>{e.nodes=t.payload.nodes,t.payload.nodesDataLoaded&&(e.nodesDataLoaded=t.payload.nodesDataLoaded)},setTreeFinishedInitialTransition:(e,t)=>{e.treeFinishedInitialTransition=t.payload},setNodesTreeStylesState:(e,t)=>{e.styles=t.payload}},extraReducers:e=>{e.addCase(d.fulfilled,(e,t)=>{e.nodes=t.payload})}}),d=(0,i.zD)("nodesTree/loadTreeNodes",async e=>{var t;let a=await (0,s.getChromeCurrentWindowId)();if(!a)return[];let i=null!==(t=await n.L.load(a))&&void 0!==t?t:[];return e&&(i=i.filter(t=>(0,o.q8)(t)&&(t.id===e||t.ancestralNodeIds.includes(e)))),i}),{setSelectionStartTabId:l,setDraggingNode:c,setNodes:g,setTreeFinishedInitialTransition:u,setNodesTreeStylesState:p}=r.actions,h=r.reducer},36840:(e,t,a)=>{a.d(t,{Ay:()=>f,Tb:()=>g,ZG:()=>l,aE:()=>b,cT:()=>T,hb:()=>u,hn:()=>c,yd:()=>h});var i=a(69173),s=a(78639),n=a(94778),o=a(93034);let r=(0,o.tZ)(!0,o.W4.state,"optionsReducer"),d=(0,i.Z0)({name:"options",initialState:s.K,reducers:{setOptions:(e,t)=>t.payload,setLastSelectedOptionPage:(e,t)=>{e.lastSelectedOptionPageKey=t.payload},setSideMenuCollapsed:(e,t)=>{e.sideMenuCollapsed=t.payload},setThemeSettings:(e,t)=>{e.themeSettings=t.payload},setCustomizedTabNodesTreeThemeSettings:(e,t)=>{e.themeSettings.customizedTabNodesTreeThemeSettings=t.payload},setNodesTreeSettings:(e,t)=>{e.nodesTreeSettings=t.payload},setDeveloperSettings:(e,t)=>{e.developerSettings=t.payload}},extraReducers(e){e.addCase(l.fulfilled,(e,t)=>t.payload)}}),l=(0,i.zD)("options/load",async e=>{let t=await n.O.loadData({verifyDataIntegrity:e});return r.logPT(l.name,{options:t}),t}),{setOptions:c,setThemeSettings:g,setCustomizedTabNodesTreeThemeSettings:u,setNodesTreeSettings:p,setDeveloperSettings:h,setLastSelectedOptionPage:b,setSideMenuCollapsed:T}=d.actions;d.actions;let f=d.reducer},35497:(e,t,a)=>{a.d(t,{A:()=>n,a:()=>s});let i=(0,a(69173).Z0)({name:"popupMenu",initialState:{popupMenu:void 0},reducers:{setPopupMenu:(e,t)=>{e.popupMenu=t.payload}},extraReducers:e=>{}}),{setPopupMenu:s}=i.actions,n=i.reducer},80363:(e,t,a)=>{a.d(t,{$k:()=>d,Ay:()=>g,Wc:()=>l,dx:()=>c});var i=a(69173),s=a(28017),n=a(67426);(0,s.IP)();let o={disabledListenerIds:new Set},r=(0,i.Z0)({name:"windowLocalStorageEventListeners",initialState:o,reducers:{enableListenerIds:(e,t)=>{t.payload.forEach(t=>e.disabledListenerIds.delete(t))},disableListenerIds:(e,t)=>{t.payload.forEach(t=>e.disabledListenerIds.add(t))}}}),d=e=>n.store.getState().windowLocalStorageEventListeners.disabledListenerIds.has(e),{enableListenerIds:l,disableListenerIds:c}=r.actions,g=r.reducer},39296:(e,t,a)=>{},87855:(e,t,a)=>{a.d(t,{s:()=>r});var i=a(26549),s=a(93034),n=a(37390);class o{constructor(e=o.name){this.queue=i.Ay.queue(async(e,t)=>{var a;let i=new Date().getTime().toString(),o=(0,s.tZ)(e.logger.ifPrint,e.logger.tagStyle,[...e.logger.prefixTags,...(0,n.eC)(e.extraTags),...(0,n.eC)(this.logTags),i]);e.logger=o;try{if(o.ifPrint&&!e.disableLog){let t="📡 An async task is executed.";(null===(a=e.options)||void 0===a?void 0:a.overrideLog)?await e.options.overrideLog(o,t,e):o.logP(t,e)}await e.run(e.logger,e.payload),null==t||t()}catch(e){o.error(e),e instanceof Error&&(null==t||t(e))}},1),this.push=this.queue.push,this.pushAsync=e=>{this.queue.push(e,t=>{var a;t instanceof Error&&(null===(a=e.callback)||void 0===a||a.call(e,t))})},this.logTags=e}}let r=new o},61566:(e,t,a)=>{a.d(t,{af:()=>c,yv:()=>l});var i=a(35904),s=a(27566),n=a(78154),o=a(93034);async function r(){let e=(0,o.tZ)(!0,o.W4.script,r.name),t=(await i.k.loadData()).p;if(!t){e.logP("Passphrase does not exist. Generating a new one.");let a=new Uint8Array(16);crypto.getRandomValues(a),t=btoa(String.fromCharCode.apply(null,[...a]));try{await s.F2.disableListener(n.x7.SERVICE_WORKER),await i.k.saveData({p:t}),e.logP("New passphrase generated and saved")}catch(t){e.errorP(t)}finally{await s.F2.enableListener(n.x7.SERVICE_WORKER)}}return t}async function d(e,t){let a=atob(e),i=new TextEncoder().encode(a),s=await crypto.subtle.importKey("raw",i,{name:"PBKDF2"},!1,["deriveKey"]);return await crypto.subtle.deriveKey({name:"PBKDF2",salt:t,iterations:1e5,hash:"SHA-256"},s,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}async function l(e,t=r){let a=(0,o.tZ)(!1,o.W4.script,l.name);a.logP("encrypt data",e);let i=crypto.getRandomValues(new Uint8Array(16));a.logP("salt",i);let s=await d(await t(),i);a.logP("CryptoKey",s);let n=new TextEncoder().encode(e),c=crypto.getRandomValues(new Uint8Array(12));a.logP("iv",c);let g=new Uint8Array(await crypto.subtle.encrypt({name:"AES-GCM",iv:c},s,n));a.logP("encryptedArray",g);let u=new Uint8Array(i.byteLength+c.byteLength+g.byteLength);return u.set(i,0),u.set(c,i.byteLength),u.set(g,i.byteLength+c.byteLength),a.logP("result",u),btoa(String.fromCharCode.apply(null,[...u]))}async function c(e,t=r){let a=(0,o.tZ)(!1,o.W4.script,c.name);a.logP("decrypt data",{encryptedData:e});try{let i=new Uint8Array(atob(e).split("").map(e=>e.charCodeAt(0))),s=i.slice(0,16),n=i.slice(16,28),o=i.slice(28);a.logP("Get passphrase");let r=await t();a.logP("Generate AES key");let l=await d(r,s);a.logP("AES key generated",{key:l,passphrase:r});let c=await crypto.subtle.decrypt({name:"AES-GCM",iv:n},l,o);a.logP("Data decrypted",{decryptedData:c});let g=new TextDecoder().decode(c);return a.logP("Data decoded",{decodedData:g}),g}catch(e){throw a.errorP("Decrypt data error.",e),e}}},77638:(e,t,a)=>{a.d(t,{X:()=>n});var i=a(93034),s=a(44788);class n{constructor(e){this.callbackStates={},this.id=e}getListenersLog(){return Object.keys(this.callbackStates).reduce((e,t)=>{let a=this.callbackStates[t];return e[t]=a.enabled,e},{})}async disableListener(e){this.nativeDisableListener(e),this.callbackStates[e]||await (0,s.w)({type:"toggleListener",managerId:this.id,listenerId:e,enabled:!1},{logTags:[this.id]})}nativeDisableListener(e){let t=this.callbackStates[e];t&&t.enabled&&(this.nativeRemoveListener(t.callback,e),this.callbackStates[e]=Object.assign(Object.assign({},t),{enabled:!1}),t.logger.logPT(this.nativeDisableListener.name,{listeners:this.getListenersLog()}))}async enableListener(e){this.nativeEnableListener(e),this.callbackStates[e]||await (0,s.w)({type:"toggleListener",managerId:this.id,listenerId:e,enabled:!0},{logTags:[this.id]})}nativeEnableListener(e){let t=this.callbackStates[e];t&&!t.enabled&&(this.nativeAddListener(t.callback,e),this.callbackStates[e]=Object.assign(Object.assign({},t),{enabled:!0}),t.logger.logPT(this.nativeEnableListener.name,{listeners:this.getListenersLog()}))}removeListener(e){let t=this.callbackStates[e];t&&(this.nativeRemoveListener(this.callbackStates[e].callback,e),chrome.runtime.onMessage.removeListener(this.callbackStates[e].toggleListenerMessageListener),delete this.callbackStates[e],t.logger.logPT(this.removeListener.name,{listeners:this.getListenersLog()}))}addListener(e,t,a,s={ifPrintLog:!1,logTags:void 0,onlyPrintOnChange:!0}){let n=(null==s?void 0:s.logTags)?Array.isArray(s.logTags)?[...s.logTags,this.id]:[s.logTags,this.id]:[this.id],o=(0,i.tZ)(s.ifPrintLog,i.W4.script,n);o.gPT(this.addListener.name,{listenerId:e});let r=this.callbackStates[e];r&&(o.log("Listener exists. Remove it before adding it."),this.removeListener(e)),this.callbackStates[e]={callback:this.provideCallback(a,t,e,o,s),toggleListenerMessageListener:(t,a,i)=>{(null==t?void 0:t.type)==="toggleListener"&&t.managerId===this.id&&t.listenerId===e&&(o.receivePT(t.timestamp,"Received toggle listener message.",t),t.enabled?this.nativeEnableListener(e):this.nativeDisableListener(e))},logger:o,enabled:!r||r.enabled},(null==r?void 0:r.enabled)===!1?o.log("Listener is not currently enabled. Do not add the listener."):(o.log("Add the listener."),this.nativeAddListener(this.callbackStates[e].callback,e),chrome.runtime.onMessage.addListener(this.callbackStates[e].toggleListenerMessageListener)),o.ge()}}},11080:(e,t,a)=>{a.d(t,{d:()=>h});var i=a(2531),s=a(56615),n=a(3022),o=a(24817),r=a(69173),d=a(92935),l=a(93034),c=a(44788),g=a(87521),u=a(68687);let p=(0,l.tZ)(!0,l.W4.action,h.name);async function h(e){var t;p.startMainTaskPerformanceTimer();let{oldNodes:a,chromeGroupsAndTabs:l,fixMissingParents:h=!1,nodesWithNewProperties:b,onNewTreeNodesBuiltBeforeFixMissingAncestors:T,onFinished:f,nodeTransformers:y}=e;p.gP({nodes:(0,o.Op)(a),fixMissingParents:h,nodesWithNewProperties:b,onNewTreeNodesBuiltBeforeFixMissingAncestors:T,onFinished:f}),p.startSubTaskPerformanceTimer(),a=(0,o.LD)(a),p.log(`Old nodes cloned. ${p.subTaskPerformanceLog}`),p.startSubTaskPerformanceTimer(),p.action("Get Chrome tabs and groups.");let{chromeTabs:N,chromeTabGroups:m}=null!=l?l:await (0,s.hs)();p.success(`Done get Chrome tabs and groups. ${p.subTaskPerformanceLog}`),p.startSubTaskPerformanceTimer(),p.gls("Build group nodes from Chrome TabGroup.");let v=m.map(e=>({group:e,childrenTabs:N.filter(t=>t.groupId===e.id)})),A=new Map,S=m.reduce((e,t,s,n)=>{var d;let l=(0,o.j7)(a,t.id,!0),c=(0,i.Cg)(null!==(d=null==l?void 0:l.uuid)&&void 0!==d?d:(0,r.Ak)(),t);l&&(0,o.aL)(c,l);let g=null==b?void 0:b[c.id];return g&&(c=Object.assign(Object.assign({},c),g)),c=Object.assign(Object.assign({},c),{areChildrenExpanded:!t.collapsed}),e.push(c),A.set(t.id,c),e},[]);p.ge(),p.success(`Group nodes built. ${p.subTaskPerformanceLog}`,S),p.startSubTaskPerformanceTimer(),p.gls("Build tree nodes from Chrome tabs.",{chromeTabs:N});let O=N.reduce((e,t,s,d)=>{var l,c;let g=t.id?(0,o.Sh)(a,t.id,!0):void 0,h=(0,i.L5)(null!==(l=null==g?void 0:g.uuid)&&void 0!==l?l:(0,r.Ak)(),t);g?(0,o.aL)(h,g):p.log("No old tab node. Skip.");let T=null==b?void 0:b[h.id];if(T&&(h=Object.assign(Object.assign({},h),T)),t.groupId!==chrome.tabGroups.TAB_GROUP_ID_NONE){let e=v.find(e=>e.group.id===t.groupId);h.indexInGroup=null==e?void 0:e.childrenTabs.findIndex(e=>e.id===t.id)}let f=d[s-1],y=t.groupId===chrome.tabGroups.TAB_GROUP_ID_NONE&&f&&f.groupId!==chrome.tabGroups.TAB_GROUP_ID_NONE;y&&p.log(`First child of group: "${t.title}".`),h.isFirstTabNodeAfterGroup=y;let N=t.groupId!==chrome.tabGroups.TAB_GROUP_ID_NONE&&(f&&(f.groupId===chrome.tabGroups.TAB_GROUP_ID_NONE||f.groupId!==t.groupId)||!f);N&&p.log(`First tab node in group: "${t.title}"`),h.isFirstTabNodeInGroup=N;let m=d[s+1],O=t.groupId!==chrome.tabGroups.TAB_GROUP_ID_NONE&&(m&&(m.groupId===chrome.tabGroups.TAB_GROUP_ID_NONE||m.groupId!==t.groupId)||!m);if(O&&p.log(`Last tab node in group: "${t.title}"`),h.isLastTabNodeInGroup=O,h.isGroupExpanded=null===(c=A.get(t.groupId))||void 0===c?void 0:c.areChildrenExpanded,h.pinned&&(h=Object.assign(Object.assign({},(0,o.IC)(h)),{ancestralNodeIds:[]})),h.active=t.active,h.groupColor=void 0,t.groupId===chrome.tabGroups.TAB_GROUP_ID_NONE)e.push(h);else{let a=S.find(e=>e.id===t.groupId);e.find(e=>e.id===a.id)||e.push(a),(h=(0,u.as)(a,h,e,a.areChildrenExpanded)).groupColor=n.vJ[a.color].color,e.push(h)}return e},[]);p.ge();let C=(0,o.Op)(O);p.success(`New tree nodes built. ${p.subTaskPerformanceLog}`,C),T&&(p.startSubTaskPerformanceTimer(),p.action("onNewTreeNodesBuiltBeforeFixMissingAncestors is provided. Run it."),T(O),p.success(`Done onNewTreeNodesBuiltBeforeFixMissingAncestors. ${p.subTaskPerformanceLog}`,C)),h&&(p.startSubTaskPerformanceTimer(),p.action("Fix missing parents."),(0,o.u)(O,g.store.options.nodesTreeSettings.promoteFirstChildAsParentOnParentCloseSetting),p.success(`Done fix missing parents. ${p.subTaskPerformanceLog}`,C)),p.startSubTaskPerformanceTimer(),p.gls("Compute properties.");let w=(0,o.fc)(O).filter(e=>e.pinned);O=O.reduce((e,t,a,i)=>{var s;switch(t.nodeType){case"tabNode":t.directChildrenNodeIds=[],t.childrenIds={},t.descendantNodesCount=0;let n=(0,o.gJ)(t),r=a+1;0===n&&(t.zIndex=1e3*(n+1)+a);let l=0;for(;r<O.length;){let e=O[r];if(!(0,o.q8)(e))break;let a=(0,o.gJ)(e);if(n>=a)break;if(n===a-1&&e.ancestralNodeIds.includes(t.id)&&(t.directChildrenNodeIds.push(e.id),e.zIndex=1e3-100*(n+1)+l,l++),r+1<O.length){let i=O[r+1];if(!(0,o.q8)(i)||(0,o.gJ)(i)<=a){let a=e.ancestralNodeIds.indexOf(t.id),i=e.ancestralNodeIds.slice(0,a).reduce((e,t,a,i)=>e={[t]:e},{[e.id]:void 0});t.childrenIds=(0,d.merge)(t.childrenIds,i)}}r++,t.descendantNodesCount++}t.isFirstNonPinnedTabNodeInTree=!t.pinned&&a===O.filter(e=>(0,o.q8)(e)&&e.pinned).length,t.isLastTabNodeInTree=a===O.length-1,t.isLastPinnedTabInTree=t.id===(null===(s=w[w.length-1])||void 0===s?void 0:s.id);break;case"groupNode":t.zIndex=1e3+a+1e3,t.descendantNodesCount=0,t.descendantNodesCount=O.filter(e=>"tabNode"===e.nodeType&&e.groupId===t.id).length,t.directChildrenNodeIds=O.filter(e=>"tabNode"===e.nodeType&&e.groupId===t.id&&0===(0,o.gJ)(e)).map(e=>e.id)}return e},O);let L=(0,o.Op)(O);if(p.ge(),p.success(`Done computing properties. ${p.subTaskPerformanceLog}`,L),p.startSubTaskPerformanceTimer(),p.action("Save removed tab nodes.",a),(0,c.w)({type:"saveRemovedTreeNodesData",removedNodes:a}).catch(e=>p.error("Failed to save removed tab nodes.",e)),p.success(`Done save removed tab nodes. ${p.subTaskPerformanceLog}`),y&&(O=(0,o.SQ)(O,y)),f){p.startSubTaskPerformanceTimer(),p.action("onFinished is provided. Run it."),O=null!==(t=f(O))&&void 0!==t?t:O;let e=(0,o.Op)(O);p.success(`Done onFinished. ${p.subTaskPerformanceLog}`,e)}p.startSubTaskPerformanceTimer(),p.action("Clone nodes for log.");let D=(0,o.Op)(O),E=(0,o.Op)(a);return p.success(`Done clone nodes for log.. ${p.subTaskPerformanceLog}`),p.end(`Done building new tree nodes. ${p.mainTaskPerformanceLog}`,{treeNodes:D,oldTabNodes:E}),p.ge(),O}},68687:(e,t,a)=>{a.d(t,{WB:()=>n,as:()=>o});var i=a(24817),s=a(93034);function n(e,t,a){let d;let l=(0,s.tZ)(!1,s.W4.action,n.name);l.gcP({nodes:e,node:t}),l.loop("Run nodes reducer to update tab nodes.",{expanded:a});let c="groupNode"===t.nodeType,g="tabNode"===t.nodeType;return d=e.reduce((e,n,d)=>{let u;return n.id===t.id?(l.check("node.id === actionNode.id, clone it",{nodeTitle:n.title,nodeId:n.id,actionNodeId:t.id}),u=Object.assign(Object.assign({},n),{areChildrenExpanded:a})):(0,i.q8)(n)&&(c?u=o(t,n,e,a):g&&(u=function e(t,a,n,o){let d=(0,s.tZ)(!1,s.W4.action,e.name);d.gcP({actionNode:t,node:a});let l=a;try{if(!(0,i.UW)(a,t))return a;(0,i.gJ)(a)===(0,i.gJ)(t)+1?(d.check("actionNode is tab node, and node is direct child, clone and update it",{nodeTitle:a.title,nodeLevel:(0,i.gJ)(a)}),l=Object.assign(Object.assign({},l),{isExpanded:o,isExpandingOrCollapsing:!0})):l=r(n,l,o)}catch(e){d.error(e)}finally{d.ge()}return l}(t,n,e,a))),e.push(u||n),e},[]),l.stop("Done.",{newAndOldNodes:d}),l.ge(),d}function o(e,t,a,n){let d=(0,s.tZ)(!1,s.W4.action,o.name);d.gcP({groupNode:e,tabNode:t});let l=t;try{if(t.groupId!==e.id)return t;0===(0,i.gJ)(t)?t.isExpanded!==n&&(d.check("actionNode is group node, and node is root level, clone and update it",{nodeTitle:t.title,nodeLevel:(0,i.gJ)(t)}),l=Object.assign(Object.assign({},l),{isExpanded:n,isExpandingOrCollapsing:!0})):l=r(a,t,n),l.isGroupExpanded!==n&&(l=Object.assign(Object.assign({},l),{isGroupExpanded:n}))}catch(e){d.error(e)}finally{d.ge()}return l}function r(e,t,a){let s=t;if(a){let a=(0,i.zv)(t.ancestralNodeIds[0],e);a&&(a.isExpanded&&a.areChildrenExpanded?t.isExpanded||(s=Object.assign(Object.assign({},t),{isExpanded:!0,isExpandingOrCollapsing:!0})):t.isExpanded&&(s=Object.assign(Object.assign({},t),{isExpanded:!1,isExpandingOrCollapsing:!0})))}else t.isExpanded&&(s=Object.assign(Object.assign({},t),{isExpanded:!1,isExpandingOrCollapsing:!0}));return s}},65343:(e,t,a)=>{a.d(t,{c:()=>i});function i(e,t){let{includeOpenerTabNode:a}=t;return e&&!e.pinned?a?[e.id,...e.ancestralNodeIds]:[...e.ancestralNodeIds]:[]}},1581:(e,t,a)=>{a(56615),a(3735),a(84200),a(24817),a(3022),a(2613),a(39296),a(93034),a(37390);var i=function(e){return e.Matched="Matched",e.GroupsUnmatched="GroupsUnmatched",e.ListSizeDifferenceExceedsAllowedThreshold="ListSizeDifferenceExceedsAllowedThreshold",e.ExceedAllowedTabUnmatchedCount="ExceedAllowedTabUnmatchedCount",e}(i||{}),s=function(e){return e.Matched="Matched",e.Unmatched="Unmatched",e}(s||{})}}]);